<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Voip | Seth Dang&#39;S</title>
<meta name="keywords" content="">
<meta name="description" content="技术博客与知识分享">
<meta name="author" content="Seth">
<link rel="canonical" href="seth.dpdns.org/categories/voip/">
<link crossorigin="anonymous" href="seth.dpdns.org/assets/css/stylesheet.e1f5c4cae44599655f7ff95195ff89c8cb3adbda94f2b1581a434ab2b4d4e6cf.css" integrity="sha256-4fXEyuRFmWVff/lRlf&#43;JyMs629qU8rFYGkNKsrTU5s8=" rel="preload stylesheet" as="style">
<link rel="icon" href="seth.dpdns.org/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="seth.dpdns.org/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="seth.dpdns.org/favicon-32x32.png">
<link rel="apple-touch-icon" href="seth.dpdns.org/apple-touch-icon.png">
<link rel="mask-icon" href="seth.dpdns.org/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" type="application/rss+xml" href="seth.dpdns.org/categories/voip/index.xml">
<link rel="alternate" hreflang="en" href="seth.dpdns.org/categories/voip/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="seth.dpdns.org/categories/voip/">
  <meta property="og:site_name" content="Seth Dang&#39;S">
  <meta property="og:title" content="Voip">
  <meta property="og:description" content="技术博客与知识分享">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="website">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Voip">
<meta name="twitter:description" content="技术博客与知识分享">

</head>

<body class="list" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="seth.dpdns.org/" accesskey="h" title="Seth Dang&#39;S (Alt + H)">Seth Dang&#39;S</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
        </ul>
    </nav>
</header>
<main class="main"> 
<header class="page-header">
  <h1>
    Voip
  </h1>
</header>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">浅析电信封杀解决  
    </h2>
  </header>
  <div class="entry-content">
    <p>VOIP电信封杀与反封杀
一、 封软交换平台的端口
国际电联定义的IP通信信令端口是1719、1720等，终端（不管是软电话、ip电话还是语音网关）连上网后都需要注册到软交换平台，就像QQ上网要注册到QQ的服务器一样，这样系统才知道这个终端上线了，终端的ip和端口号是多少，并记录下来。有别的终端呼叫这个终端系统就会在数据库中找出这个终端注册后记录下来的ip和端口号，把数据发往这个地址。
1、 电信封杀手段
电信可以封了1719、1720端口，就是在数据包中目的地址的端口为1719的数据包，把这样的数据包处理掉，使终端无法在软交换平台进行数据交换，这个时候，你听到电话连接不通的声音，在平台查看网关注册在线，但是信令不通，电话也就拨打不通。
2、 反封杀手段
可以不使用H323约定的1719端口，使用别的端口，这样就规避了电信的封杀端口的手段。不过这需要终端的配合，终端中设置软交换平台的端口号改成软交换平台设置的端口号。
有人建议把端口改成80，这样可以在有防火墙并且只开放少数常有端口（比如http的80、ftp的21、邮件的13和10）的环境中使用 ，但是需要你的平台和终端都支持端口的修改和调整。
二、 封软交换平台的ip
软交换平台是IP通信系统的核心，指挥中心，它负责用户的管理、终端的注册、通话的管理等。
1、 电信的封杀手段
电信不仅可以封端口，还可以把整个软交换平台的ip地址给封掉，就是在数据包中目的地址的ip为软交换平台的ip的数据包，把这样的数据包处理掉，使终端无法注册到软交换平台。
2、 反封杀手段
这个手段十分毒辣，把所有发往软交换平台的数据包都处理掉，数据无法到达软交换平台。换端口是没有用了，只能是换ip，就是换软交换平台的ip。一般软交换平台都是安装在托管的服务器，拥有一个固定的ip地址，要换软交换平台的ip还是比较麻烦的。有两个方法：
2.1、 多个软交换平台备份
多准备几个软交换平台服务器，不同的ip地址，几个软交换平台同时工作。需要终端具有支持主从备份的功能，终端中可以设置多个软交换平台，自动备份，一个注册不上自动换另一个注册。这样可以部分的对付封杀软交换平台的ip问题，当然，如果几个软交换平台同时被封，还是玩完。
2.2、 采用动态ip的软交换平台服务器
一般拨号上网的方式都是动态的ip，每次拨号后都会被分配一个不同ip地址，像ADSL，小区宽带用虚拟拨号的都是这样。可以采用带宽较宽的小区宽带（一般有10M的带宽）来做动态软交换平台服务器。申请一个域名，用花生壳之类的动态域名系统做动态域名的解析，不管这个软交换平台服务器的ip怎么变，这个域名解析出来的ip总是软交换平台服务器目前的ip。
这样可以人为的让软交换平台服务器定期的重新拨号获取不同的ip地址，电信估计抓也来不及。
不过这个做法需要终端的配合，终端软交换平台的设置只能设置成软交换平台的域名，如果只能设置软交换平台为ip形式的终端就不适用了。
注意：还是不要给他发现你的软交换IP是关键，不要使用特殊端口传输数据。
三、 封落地网关的ip
voip系统是由终端、软交换平台、中继网关、PSTN共同组成的，其中中继网关是voip语音从网络通往普通电话网的桥梁。
一般的，终端注册到软交换平台，终端呼叫某个电话时，软交换平台会控制通话双方的信令传送，送振铃、忙音等信号，一旦通话双方连接上后，语音信号会在软交换平台的指引下直接从终端到中继网关之间传送。
1、 电信的封杀手段
电信可以把中继网关（落地网关）的ip给封掉，跟封软交换平台的ip一样，在数据包中目的地址的ip为中继网关的ip的数据包，把这样的数据包处理掉。这样的话，一般的结果就是，终端注册到软交换平台正常，但是一拨电话就会断，因为通往中继网关的语音数据走不到中继网关。
2、 反封杀手段
使用具有中继网关备份功能的软交换平台系统，然后多找几个落地服务商，多个落地备份使用。在一个网关走不通时自动走下一个网关，再不行再换。
四、 封杀voip的协议
目前为止，voip的协议大概有三种：H323、SIP、MGCP。
其中SIP跟TCP一样是传输层的协议，H323是一个协议族，部分协议是在TCP之上的应用层协议，部分是在UDP之上的应用协议，对MGCP不甚了解。这些协议都是有标准的，都是建立在ip协议之上的，用ip数据包传送的。
1、 电信的封杀手段
电信可以把经过电信网络的数据进行过滤，发现包含上述协议的数据包就处理掉。这就需要电信解开数据包就行处理了，至于电信那采用什么方法去每个数据包都解开分析，比较困难。
2、 反封杀手段
封杀协议是要分析数据包，找到其中协议的特征字段来判断的，是标准的协议，就能根据协议的标准来判断一个数据包是不是这个协议的数据包。但是可以将标准的协议数据重新编码，然后将数据包中的协议标志字段改成一个非标准的标志，然后在接受端将数据重新解码，恢复成原来的协议数据。这样，电信就不会认得你传送的是什么协议的数据包，也无从封杀了。
五、 UDP端口的封杀
一般IP通信都是采用UDP端口来传输媒体流数据包，一般采用大的UDP端口数来传输，所以电信可以在自己的网络上封住这些端口。
1、 电信的封杀手段
电信一般是设置20000以上的UDP端口或者30000以上的UDP端口的数据包给处理掉，这样一来，你的电话可以拨打通，双方听不到声音。
2、 反封杀手段
改变你的语音包在UDP端口传输的端口，一般电信不敢把自己用户的UDP端口都封，因为那样封，上网的很多功能都无法实现，电信是很难给其网络用户交待，所以你只要改变这些端口就可以解决，改变是需要你的软交换平台和终端都支持才可以。
六、目前超级解决办法
建立IP通信用户的私网或者VPN，但是成本太高。尤其是虚拟运营商，需要在用户端、软交换平台、落地网关都建立这种私网或者VPN，成本还是很高。
总之，只要做IP通信技术的公司做了技术准备，你的IP通信注册、信令、语音所使用的端口可以随意调整，最好是可以自己寻找端口来传输，做虚拟运营的时候考虑得周到一些，全面一些，电信一般还是比较在流量众多的IP网络里把你的包给纠出来，查找你的IP再封杀的。
技术革新，行业才能进步！
</p>
  </div>
  <footer class="entry-footer"><span title='2009-11-08 23:08:41 +0800 +0800'>November 8, 2009</span>&nbsp;·&nbsp;Seth</footer>
  <a class="entry-link" aria-label="post link to 浅析电信封杀解决  " href="seth.dpdns.org/posts/%E6%B5%85%E6%9E%90%E7%94%B5%E4%BF%A1%E5%B0%81%E6%9D%80%E8%A7%A3%E5%86%B3/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent"> Original X100P 原装卡 Trixbox(Asterisk) voip 不是兼容卡哦 
    </h2>
  </header>
  <div class="entry-content">
    <p>之前断货有1个多月了，现在又找到一些了，请抓紧购买。
支持各类流行的Asterisk软件，如Trixbox, Asterisk, Elastix ,asterCC-BOX,Askozia等等
注：我们没有办法提供任何软件使用上的技术支持的，你会使用才买，若没有任何使用经验请谨慎购买，我们提供不了帮助的。
这个 单口（虽然你看到2个口，他们其实是并联的，方便接一台电话机做逃生口）FXO卡是给Asterisk/Trixbox系统用来落地用的。
本物品淘宝直接购买，请想要在淘宝做分销的免谈。主要照顾asterisk的初学者。
二手货，更换了新挡板，没有螺丝印，只有一张卡，防静电袋彩盒包装；无电话线，说明书，光盘。保修一年。包邮98元，多买不加减邮费。这可不是替代品或者兼容卡，原装卡行情在28USD左右，因为帮国外客户OEM，所以成本价照顾China客户。库存备品，卖完为止，请抓紧时间购买。这个可是带来电显示FSK制式，深圳电信环境测试后发货。
Wildcard X100P
A single port FXO PCI interface card for interfacing with a standard analog phone line.
不是兼容卡（兼容卡用 Ambient 3200芯片），是原装卡。
1.没有回音感谢motorola的工程师的大力协助！
2.带来电显示（FSK制式，不支持DTMF 广州，山东某些地方）
3.忙音检测 不需要补丁
市面上其他兼容卡都有1，2，3的问题。所以还是抓紧时间买原装卡划算。保值，原装卡芯片已经停产了，有收藏价值。价格根据库存调整，起始价格98元。
http://www.asterisk.org/hardware 官方只有克隆卡，原装卡国外都买不到了
我们快递公司一定走申通速递，平邮我也一样走快递。
新手先去看看一下后面的丰富的参考链接，然后再去www.trixbox.com.cn问问题。本人所有卡亲自测试，所以一般卡是没问题的，关于开源的事情还是去论坛看看。
www.x100p.com不要认为我们的卡和这家一样，他们在卖的卡和我的芯片封装不一样，我的品质和他们不相上下，甚至比他们要好。不过我们的设备X100P的ID是一样的（motorola）。
复制以下链接，粘贴到浏览器，就可以看到了。
http://www.sureteq.com/asterisk/trixbox.htm 风云提供链接。
以下链接证明克隆卡有回音，原装卡是没有的。
http://www.voip-info.org/tiki-index.php?page=X100P&#43;clone
The Digium X100P FXO card, and the DigitNetworks X100P OEM clone card, are actually Intel V92 Data/Fax/Voice modem cards.
以上文字说明这个东西就是猫，比较特殊的猫。呵呵！
</p>
  </div>
  <footer class="entry-footer"><span title='2009-11-08 21:51:11 +0800 +0800'>November 8, 2009</span>&nbsp;·&nbsp;Seth</footer>
  <a class="entry-link" aria-label="post link to  Original X100P 原装卡 Trixbox(Asterisk) voip 不是兼容卡哦 " href="seth.dpdns.org/posts/original-x100p-%E5%8E%9F%E8%A3%85%E5%8D%A1-trixboxasterisk-voip-%E4%B8%8D%E6%98%AF%E5%85%BC%E5%AE%B9%E5%8D%A1%E5%93%A6/"></a>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="seth.dpdns.org/">Seth Dang&#39;S</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
