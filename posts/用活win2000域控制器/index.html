<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>用活Win2000域控制器 | Seth Dang博客</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="也许不少人会认为域控制器的使用，是非常简单的一件事情；但当你与域控制器进行了“亲密”接触之后，你会发现事实并非想象的那样简单，因为在实际管理域控制器的过程中，你或许会碰到许多特殊要求；面对不同的要求，你需要对域控制器进行个性化的控制和管理。
巧“借”域来装程序
在包含有多台工作站的局域网中，为每一台工作站安装相同的应用程序，看似是一件轻松而又简单的事情，其实实际操作起来很费时间，如果同时在每台工作站中安装多个应用程序的话，那工作量就更大了！为了能快速、高效地将多个应用程序安装到每台工作站中，你可以按照下面的方法来进行批量操作：
首先将局域网服务器升级为域服务器，如果你的服务器还没有完成升级的话，那不妨参考相关资料完成升级任务。倘若这里的网络服务器已经完成了升级操作，而且升级好的域服务器名称为“ad.ycsti.cn”；
考虑到是给工作站安装应用程序，因此你先必须配置好应用程序的安装脚本，然后指定工作站在登录成功后自动调用程序安装脚本，从而实现自动安装应用程序的目的。在配置应用程序安装脚本时，可以先打开域服务器中记事本之类的文本编辑工具，然后在编辑界面中输入下面的源代码：
@echo off
start/wait \域服务器IP地址\aaa 111.exe
start/wait \域服务器IP地址\aaa 222.exe
……
其中“域服务器IP地址”其实就是保存有所有待安装程序的计算机IP地址，“aaa”表示保存有所有待安装程序的共享文件夹，111.exe、222.exe……表示待安装的具体应用程序名，“/wait”参数表示逐一地安装每一个应用程序，倘若没有这个参数的话，那么多个应用程序可能会出现同时安装的现象，这样容易造成安装混乱的现象。完成上面的代码输入后，单击文本编辑界面中的“文件”/“另存为”命令，在其后打开的文件保存对话框中，输入文件名“install.bat”，最后单击“保存”按钮，将上面的命令代码保存成批处理文件“install.bat”。
接着在域服务器系统桌面中，依次单击“开始”/“运行”命令，在随后打开的系统运行对话框中，输入字符串命令“DSA.MSC”，单击“确定”按钮后，打开一个标题为“Active Directory用户和计算机”的界面；用鼠标右键单击该界面左侧列表区域处的“ad.ycsti.cn”域服务器名称，从随后出现的右键菜单中单击“属性”命令，再在打开的属性设置框中单击一下“组策略”标签，在对应的标签页面中你将看到一些默认的组策略；下面你可以单击“新建”按钮，来重新创建一个新的组策略，并将该组策略的名字取为“批量安装程序”；随后再选中“批量安装程序”这个选项，并单击一下“编辑”按钮，打开具体的组策略编辑界面，该界面与单台工作站中的组策略编辑界面完全一样。依次展开组策略编辑界面中的“用户设置”、“Windows设置”、“脚本-（登录/注销）”分支，在对应“脚本-（登录/注销）”分支的右侧子窗口中，双击一下“登录”选项，在接着出现的如图1所示的对话框中，将前面创建的“INSTALL.BAT”批处理文件选中并导入进来。如果“INSTALL.BAT”批处理文件不在本地计算机的话，那么你不可以直接进入其他计算机的共享文件夹来选择，而必须通过网上邻居窗口来选择“INSTALL.BAT”批处理文件，这主要是因为工作站是通过网络方式访问“INSTALL.BAT”批处理文件的，所以必须将该批处理文件具体路径调整为网络路径。例如，要是“INSTALL.BAT”批处理文件保存在IP地址为“10.168.160.16”、共享文件夹名为“install”的工作站时，你就可以按照下面的步骤来选择并导入该文件了：先在IE浏览器地址框中输入“\10.168.160.16”，单击回车键后就能见到对应工作站中的所有共享文件夹；接着双击“install”共享文件夹图标，再在其后的界面中选中“INSTALL.BAT”，这样一来你就能在IE地址框中看到完整的网络路径了，以后再将该路径直接复制到图1所示的对话框中，并单击“确定”按钮就可以完成组策略的编辑操作了。
 图1
要想实现应用程序的批量安装目的，还需要事先将所有需要在工作站中安装的应用程序全部保存到域服务器中，以便任何拥有域帐号的工作站可以自动从服务器中复制安装源程序。首先需要在域服务器中创建一个共享名为“aaa”的文件夹，然后再把所有待安装的应用程序全部复制到该文件夹中，或者将保存有待安装的应用程序所在的文件夹设置为共享，并且将共享名称设置为“aaa”。
为了确保工作站可以顺利登录到域服务器，你还需要事先在域服务器中为每一台工作站创建登录帐号，并将这些帐号全部添加到“Account Operators”组中。如果你的工作站还没有成为域成员的话，还必须进行下面的步骤：用鼠标右键单击“我的电脑”图标，从弹出的右键菜单中执行“属性”命令，在其后出现的属性设置框中，单击“计算机名”标签，再单击对应标签页面中的“属性”按钮，接着选中“隶属于”设置项处的“域”选项，在随后被激活的文本框中输入具体的域名称，例如这里应该输入“ad.ycsti.cn”（如图2所示），再单击“确定”按钮并重新启动一下计算机系统，以后你只要输入域用户名以及密码，顺利登录进域服务器中，工作站就能自动、批量地安装应用程序了。当然在为工作站批量安装好应用程序后，必须及时在域服务器的组策略设置界面中，删除“登录脚本”策略，不然的话工作站下次登录服务器时又将会重新安装以前的应用程序了。另外还要注意的是，工作站登录进域服务器的那个用户帐户还必须具有超级管理员权限才行。
 图2
小提示：普通工作站在登录域服务器时，常常可能出现无法登录域的错误提示，这种情况多数是你没有正确设置DNS服务器IP地址造成的。由于在默认状态下，网络服务器被升级为域服务器时，已经自动把自身配置成了DNS服务器，所以其他工作站在登录该服务器时，也必须将工作站的DNS服务器设置成域服务器的IP地址。">
    <meta name="generator" content="Hugo 0.150.0">
    
    
    
      <meta name="robots" content="index, follow">
    
    <meta name="author" content="Seth">
    

    
<link rel="stylesheet" href="/ananke/css/main.min.2438bcafd7af9675c426d1a4afcd16cfff18e4e10f401071e45b5ccd3be40a0d.css" >




    


    
      

    

    

    
      <link rel="canonical" href="/posts/%E7%94%A8%E6%B4%BBwin2000%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8/">
    

    <meta property="og:url" content="/posts/%E7%94%A8%E6%B4%BBwin2000%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8/">
  <meta property="og:site_name" content="Seth Dang博客">
  <meta property="og:title" content="用活Win2000域控制器">
  <meta property="og:description" content="也许不少人会认为域控制器的使用，是非常简单的一件事情；但当你与域控制器进行了“亲密”接触之后，你会发现事实并非想象的那样简单，因为在实际管理域控制器的过程中，你或许会碰到许多特殊要求；面对不同的要求，你需要对域控制器进行个性化的控制和管理。
巧“借”域来装程序
在包含有多台工作站的局域网中，为每一台工作站安装相同的应用程序，看似是一件轻松而又简单的事情，其实实际操作起来很费时间，如果同时在每台工作站中安装多个应用程序的话，那工作量就更大了！为了能快速、高效地将多个应用程序安装到每台工作站中，你可以按照下面的方法来进行批量操作：
首先将局域网服务器升级为域服务器，如果你的服务器还没有完成升级的话，那不妨参考相关资料完成升级任务。倘若这里的网络服务器已经完成了升级操作，而且升级好的域服务器名称为“ad.ycsti.cn”；
考虑到是给工作站安装应用程序，因此你先必须配置好应用程序的安装脚本，然后指定工作站在登录成功后自动调用程序安装脚本，从而实现自动安装应用程序的目的。在配置应用程序安装脚本时，可以先打开域服务器中记事本之类的文本编辑工具，然后在编辑界面中输入下面的源代码：
@echo off
start/wait \域服务器IP地址\aaa 111.exe
start/wait \域服务器IP地址\aaa 222.exe
……
其中“域服务器IP地址”其实就是保存有所有待安装程序的计算机IP地址，“aaa”表示保存有所有待安装程序的共享文件夹，111.exe、222.exe……表示待安装的具体应用程序名，“/wait”参数表示逐一地安装每一个应用程序，倘若没有这个参数的话，那么多个应用程序可能会出现同时安装的现象，这样容易造成安装混乱的现象。完成上面的代码输入后，单击文本编辑界面中的“文件”/“另存为”命令，在其后打开的文件保存对话框中，输入文件名“install.bat”，最后单击“保存”按钮，将上面的命令代码保存成批处理文件“install.bat”。
接着在域服务器系统桌面中，依次单击“开始”/“运行”命令，在随后打开的系统运行对话框中，输入字符串命令“DSA.MSC”，单击“确定”按钮后，打开一个标题为“Active Directory用户和计算机”的界面；用鼠标右键单击该界面左侧列表区域处的“ad.ycsti.cn”域服务器名称，从随后出现的右键菜单中单击“属性”命令，再在打开的属性设置框中单击一下“组策略”标签，在对应的标签页面中你将看到一些默认的组策略；下面你可以单击“新建”按钮，来重新创建一个新的组策略，并将该组策略的名字取为“批量安装程序”；随后再选中“批量安装程序”这个选项，并单击一下“编辑”按钮，打开具体的组策略编辑界面，该界面与单台工作站中的组策略编辑界面完全一样。依次展开组策略编辑界面中的“用户设置”、“Windows设置”、“脚本-（登录/注销）”分支，在对应“脚本-（登录/注销）”分支的右侧子窗口中，双击一下“登录”选项，在接着出现的如图1所示的对话框中，将前面创建的“INSTALL.BAT”批处理文件选中并导入进来。如果“INSTALL.BAT”批处理文件不在本地计算机的话，那么你不可以直接进入其他计算机的共享文件夹来选择，而必须通过网上邻居窗口来选择“INSTALL.BAT”批处理文件，这主要是因为工作站是通过网络方式访问“INSTALL.BAT”批处理文件的，所以必须将该批处理文件具体路径调整为网络路径。例如，要是“INSTALL.BAT”批处理文件保存在IP地址为“10.168.160.16”、共享文件夹名为“install”的工作站时，你就可以按照下面的步骤来选择并导入该文件了：先在IE浏览器地址框中输入“\10.168.160.16”，单击回车键后就能见到对应工作站中的所有共享文件夹；接着双击“install”共享文件夹图标，再在其后的界面中选中“INSTALL.BAT”，这样一来你就能在IE地址框中看到完整的网络路径了，以后再将该路径直接复制到图1所示的对话框中，并单击“确定”按钮就可以完成组策略的编辑操作了。
图1
要想实现应用程序的批量安装目的，还需要事先将所有需要在工作站中安装的应用程序全部保存到域服务器中，以便任何拥有域帐号的工作站可以自动从服务器中复制安装源程序。首先需要在域服务器中创建一个共享名为“aaa”的文件夹，然后再把所有待安装的应用程序全部复制到该文件夹中，或者将保存有待安装的应用程序所在的文件夹设置为共享，并且将共享名称设置为“aaa”。
为了确保工作站可以顺利登录到域服务器，你还需要事先在域服务器中为每一台工作站创建登录帐号，并将这些帐号全部添加到“Account Operators”组中。如果你的工作站还没有成为域成员的话，还必须进行下面的步骤：用鼠标右键单击“我的电脑”图标，从弹出的右键菜单中执行“属性”命令，在其后出现的属性设置框中，单击“计算机名”标签，再单击对应标签页面中的“属性”按钮，接着选中“隶属于”设置项处的“域”选项，在随后被激活的文本框中输入具体的域名称，例如这里应该输入“ad.ycsti.cn”（如图2所示），再单击“确定”按钮并重新启动一下计算机系统，以后你只要输入域用户名以及密码，顺利登录进域服务器中，工作站就能自动、批量地安装应用程序了。当然在为工作站批量安装好应用程序后，必须及时在域服务器的组策略设置界面中，删除“登录脚本”策略，不然的话工作站下次登录服务器时又将会重新安装以前的应用程序了。另外还要注意的是，工作站登录进域服务器的那个用户帐户还必须具有超级管理员权限才行。
图2
小提示：普通工作站在登录域服务器时，常常可能出现无法登录域的错误提示，这种情况多数是你没有正确设置DNS服务器IP地址造成的。由于在默认状态下，网络服务器被升级为域服务器时，已经自动把自身配置成了DNS服务器，所以其他工作站在登录该服务器时，也必须将工作站的DNS服务器设置成域服务器的IP地址。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2007-01-05T15:24:09+08:00">
    <meta property="article:modified_time" content="2007-01-05T15:24:09+08:00">

  <meta itemprop="name" content="用活Win2000域控制器">
  <meta itemprop="description" content="也许不少人会认为域控制器的使用，是非常简单的一件事情；但当你与域控制器进行了“亲密”接触之后，你会发现事实并非想象的那样简单，因为在实际管理域控制器的过程中，你或许会碰到许多特殊要求；面对不同的要求，你需要对域控制器进行个性化的控制和管理。
巧“借”域来装程序
在包含有多台工作站的局域网中，为每一台工作站安装相同的应用程序，看似是一件轻松而又简单的事情，其实实际操作起来很费时间，如果同时在每台工作站中安装多个应用程序的话，那工作量就更大了！为了能快速、高效地将多个应用程序安装到每台工作站中，你可以按照下面的方法来进行批量操作：
首先将局域网服务器升级为域服务器，如果你的服务器还没有完成升级的话，那不妨参考相关资料完成升级任务。倘若这里的网络服务器已经完成了升级操作，而且升级好的域服务器名称为“ad.ycsti.cn”；
考虑到是给工作站安装应用程序，因此你先必须配置好应用程序的安装脚本，然后指定工作站在登录成功后自动调用程序安装脚本，从而实现自动安装应用程序的目的。在配置应用程序安装脚本时，可以先打开域服务器中记事本之类的文本编辑工具，然后在编辑界面中输入下面的源代码：
@echo off
start/wait \域服务器IP地址\aaa 111.exe
start/wait \域服务器IP地址\aaa 222.exe
……
其中“域服务器IP地址”其实就是保存有所有待安装程序的计算机IP地址，“aaa”表示保存有所有待安装程序的共享文件夹，111.exe、222.exe……表示待安装的具体应用程序名，“/wait”参数表示逐一地安装每一个应用程序，倘若没有这个参数的话，那么多个应用程序可能会出现同时安装的现象，这样容易造成安装混乱的现象。完成上面的代码输入后，单击文本编辑界面中的“文件”/“另存为”命令，在其后打开的文件保存对话框中，输入文件名“install.bat”，最后单击“保存”按钮，将上面的命令代码保存成批处理文件“install.bat”。
接着在域服务器系统桌面中，依次单击“开始”/“运行”命令，在随后打开的系统运行对话框中，输入字符串命令“DSA.MSC”，单击“确定”按钮后，打开一个标题为“Active Directory用户和计算机”的界面；用鼠标右键单击该界面左侧列表区域处的“ad.ycsti.cn”域服务器名称，从随后出现的右键菜单中单击“属性”命令，再在打开的属性设置框中单击一下“组策略”标签，在对应的标签页面中你将看到一些默认的组策略；下面你可以单击“新建”按钮，来重新创建一个新的组策略，并将该组策略的名字取为“批量安装程序”；随后再选中“批量安装程序”这个选项，并单击一下“编辑”按钮，打开具体的组策略编辑界面，该界面与单台工作站中的组策略编辑界面完全一样。依次展开组策略编辑界面中的“用户设置”、“Windows设置”、“脚本-（登录/注销）”分支，在对应“脚本-（登录/注销）”分支的右侧子窗口中，双击一下“登录”选项，在接着出现的如图1所示的对话框中，将前面创建的“INSTALL.BAT”批处理文件选中并导入进来。如果“INSTALL.BAT”批处理文件不在本地计算机的话，那么你不可以直接进入其他计算机的共享文件夹来选择，而必须通过网上邻居窗口来选择“INSTALL.BAT”批处理文件，这主要是因为工作站是通过网络方式访问“INSTALL.BAT”批处理文件的，所以必须将该批处理文件具体路径调整为网络路径。例如，要是“INSTALL.BAT”批处理文件保存在IP地址为“10.168.160.16”、共享文件夹名为“install”的工作站时，你就可以按照下面的步骤来选择并导入该文件了：先在IE浏览器地址框中输入“\10.168.160.16”，单击回车键后就能见到对应工作站中的所有共享文件夹；接着双击“install”共享文件夹图标，再在其后的界面中选中“INSTALL.BAT”，这样一来你就能在IE地址框中看到完整的网络路径了，以后再将该路径直接复制到图1所示的对话框中，并单击“确定”按钮就可以完成组策略的编辑操作了。
图1
要想实现应用程序的批量安装目的，还需要事先将所有需要在工作站中安装的应用程序全部保存到域服务器中，以便任何拥有域帐号的工作站可以自动从服务器中复制安装源程序。首先需要在域服务器中创建一个共享名为“aaa”的文件夹，然后再把所有待安装的应用程序全部复制到该文件夹中，或者将保存有待安装的应用程序所在的文件夹设置为共享，并且将共享名称设置为“aaa”。
为了确保工作站可以顺利登录到域服务器，你还需要事先在域服务器中为每一台工作站创建登录帐号，并将这些帐号全部添加到“Account Operators”组中。如果你的工作站还没有成为域成员的话，还必须进行下面的步骤：用鼠标右键单击“我的电脑”图标，从弹出的右键菜单中执行“属性”命令，在其后出现的属性设置框中，单击“计算机名”标签，再单击对应标签页面中的“属性”按钮，接着选中“隶属于”设置项处的“域”选项，在随后被激活的文本框中输入具体的域名称，例如这里应该输入“ad.ycsti.cn”（如图2所示），再单击“确定”按钮并重新启动一下计算机系统，以后你只要输入域用户名以及密码，顺利登录进域服务器中，工作站就能自动、批量地安装应用程序了。当然在为工作站批量安装好应用程序后，必须及时在域服务器的组策略设置界面中，删除“登录脚本”策略，不然的话工作站下次登录服务器时又将会重新安装以前的应用程序了。另外还要注意的是，工作站登录进域服务器的那个用户帐户还必须具有超级管理员权限才行。
图2
小提示：普通工作站在登录域服务器时，常常可能出现无法登录域的错误提示，这种情况多数是你没有正确设置DNS服务器IP地址造成的。由于在默认状态下，网络服务器被升级为域服务器时，已经自动把自身配置成了DNS服务器，所以其他工作站在登录该服务器时，也必须将工作站的DNS服务器设置成域服务器的IP地址。">
  <meta itemprop="datePublished" content="2007-01-05T15:24:09+08:00">
  <meta itemprop="dateModified" content="2007-01-05T15:24:09+08:00">
  <meta itemprop="wordCount" content="23">
  <meta itemprop="keywords" content="MSDC">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="用活Win2000域控制器">
  <meta name="twitter:description" content="也许不少人会认为域控制器的使用，是非常简单的一件事情；但当你与域控制器进行了“亲密”接触之后，你会发现事实并非想象的那样简单，因为在实际管理域控制器的过程中，你或许会碰到许多特殊要求；面对不同的要求，你需要对域控制器进行个性化的控制和管理。
巧“借”域来装程序
在包含有多台工作站的局域网中，为每一台工作站安装相同的应用程序，看似是一件轻松而又简单的事情，其实实际操作起来很费时间，如果同时在每台工作站中安装多个应用程序的话，那工作量就更大了！为了能快速、高效地将多个应用程序安装到每台工作站中，你可以按照下面的方法来进行批量操作：
首先将局域网服务器升级为域服务器，如果你的服务器还没有完成升级的话，那不妨参考相关资料完成升级任务。倘若这里的网络服务器已经完成了升级操作，而且升级好的域服务器名称为“ad.ycsti.cn”；
考虑到是给工作站安装应用程序，因此你先必须配置好应用程序的安装脚本，然后指定工作站在登录成功后自动调用程序安装脚本，从而实现自动安装应用程序的目的。在配置应用程序安装脚本时，可以先打开域服务器中记事本之类的文本编辑工具，然后在编辑界面中输入下面的源代码：
@echo off
start/wait \域服务器IP地址\aaa 111.exe
start/wait \域服务器IP地址\aaa 222.exe
……
其中“域服务器IP地址”其实就是保存有所有待安装程序的计算机IP地址，“aaa”表示保存有所有待安装程序的共享文件夹，111.exe、222.exe……表示待安装的具体应用程序名，“/wait”参数表示逐一地安装每一个应用程序，倘若没有这个参数的话，那么多个应用程序可能会出现同时安装的现象，这样容易造成安装混乱的现象。完成上面的代码输入后，单击文本编辑界面中的“文件”/“另存为”命令，在其后打开的文件保存对话框中，输入文件名“install.bat”，最后单击“保存”按钮，将上面的命令代码保存成批处理文件“install.bat”。
接着在域服务器系统桌面中，依次单击“开始”/“运行”命令，在随后打开的系统运行对话框中，输入字符串命令“DSA.MSC”，单击“确定”按钮后，打开一个标题为“Active Directory用户和计算机”的界面；用鼠标右键单击该界面左侧列表区域处的“ad.ycsti.cn”域服务器名称，从随后出现的右键菜单中单击“属性”命令，再在打开的属性设置框中单击一下“组策略”标签，在对应的标签页面中你将看到一些默认的组策略；下面你可以单击“新建”按钮，来重新创建一个新的组策略，并将该组策略的名字取为“批量安装程序”；随后再选中“批量安装程序”这个选项，并单击一下“编辑”按钮，打开具体的组策略编辑界面，该界面与单台工作站中的组策略编辑界面完全一样。依次展开组策略编辑界面中的“用户设置”、“Windows设置”、“脚本-（登录/注销）”分支，在对应“脚本-（登录/注销）”分支的右侧子窗口中，双击一下“登录”选项，在接着出现的如图1所示的对话框中，将前面创建的“INSTALL.BAT”批处理文件选中并导入进来。如果“INSTALL.BAT”批处理文件不在本地计算机的话，那么你不可以直接进入其他计算机的共享文件夹来选择，而必须通过网上邻居窗口来选择“INSTALL.BAT”批处理文件，这主要是因为工作站是通过网络方式访问“INSTALL.BAT”批处理文件的，所以必须将该批处理文件具体路径调整为网络路径。例如，要是“INSTALL.BAT”批处理文件保存在IP地址为“10.168.160.16”、共享文件夹名为“install”的工作站时，你就可以按照下面的步骤来选择并导入该文件了：先在IE浏览器地址框中输入“\10.168.160.16”，单击回车键后就能见到对应工作站中的所有共享文件夹；接着双击“install”共享文件夹图标，再在其后的界面中选中“INSTALL.BAT”，这样一来你就能在IE地址框中看到完整的网络路径了，以后再将该路径直接复制到图1所示的对话框中，并单击“确定”按钮就可以完成组策略的编辑操作了。
图1
要想实现应用程序的批量安装目的，还需要事先将所有需要在工作站中安装的应用程序全部保存到域服务器中，以便任何拥有域帐号的工作站可以自动从服务器中复制安装源程序。首先需要在域服务器中创建一个共享名为“aaa”的文件夹，然后再把所有待安装的应用程序全部复制到该文件夹中，或者将保存有待安装的应用程序所在的文件夹设置为共享，并且将共享名称设置为“aaa”。
为了确保工作站可以顺利登录到域服务器，你还需要事先在域服务器中为每一台工作站创建登录帐号，并将这些帐号全部添加到“Account Operators”组中。如果你的工作站还没有成为域成员的话，还必须进行下面的步骤：用鼠标右键单击“我的电脑”图标，从弹出的右键菜单中执行“属性”命令，在其后出现的属性设置框中，单击“计算机名”标签，再单击对应标签页面中的“属性”按钮，接着选中“隶属于”设置项处的“域”选项，在随后被激活的文本框中输入具体的域名称，例如这里应该输入“ad.ycsti.cn”（如图2所示），再单击“确定”按钮并重新启动一下计算机系统，以后你只要输入域用户名以及密码，顺利登录进域服务器中，工作站就能自动、批量地安装应用程序了。当然在为工作站批量安装好应用程序后，必须及时在域服务器的组策略设置界面中，删除“登录脚本”策略，不然的话工作站下次登录服务器时又将会重新安装以前的应用程序了。另外还要注意的是，工作站登录进域服务器的那个用户帐户还必须具有超级管理员权限才行。
图2
小提示：普通工作站在登录域服务器时，常常可能出现无法登录域的错误提示，这种情况多数是你没有正确设置DNS服务器IP地址造成的。由于在默认状态下，网络服务器被升级为域服务器时，已经自动把自身配置成了DNS服务器，所以其他工作站在登录该服务器时，也必须将工作站的DNS服务器设置成域服务器的IP地址。">

      
    
	
  </head><body class="ma0 avenir bg-near-white production">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l center items-center justify-between">
    <a href="/" class="f3 fw2 hover-white white-90 dib no-underline">
      
        Seth Dang博客
      
    </a>
    <div class="flex-l items-center">
      

      
      <div class="ananke-socials"></div>

    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  
  <article class="flex-l mw8 center ph3 flex-wrap justify-between">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Posts
      </aside><div id="sharing" class="mt3 ananke-socials"></div>
<h1 class="f1 athelas mt3 mb1">用活Win2000域控制器</h1>
      
      <p class="tracked"><strong>Seth</strong>
      </p>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2007-01-05T15:24:09+08:00">January 5, 2007</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>也许不少人会认为域控制器的使用，是非常简单的一件事情；但当你与域控制器进行了“亲密”接触之后，你会发现事实并非想象的那样简单，因为在实际管理域控制器的过程中，你或许会碰到许多特殊要求；面对不同的要求，你需要对域控制器进行个性化的控制和管理。</p>
<p><strong>巧“借”域来装程序</strong></p>
<p>在包含有多台工作站的局域网中，为每一台工作站安装相同的应用程序，看似是一件轻松而又简单的事情，其实实际操作起来很费时间，如果同时在每台工作站中安装多个应用程序的话，那工作量就更大了！为了能快速、高效地将多个应用程序安装到每台工作站中，你可以按照下面的方法来进行批量操作：</p>
<p>首先将局域网服务器升级为域服务器，如果你的服务器还没有完成升级的话，那不妨参考相关资料完成升级任务。倘若这里的网络服务器已经完成了升级操作，而且升级好的域服务器名称为“ad.ycsti.cn”；</p>
<p>考虑到是给工作站安装应用程序，因此你先必须配置好应用程序的安装脚本，然后指定工作站在登录成功后自动调用程序安装脚本，从而实现自动安装应用程序的目的。在配置应用程序安装脚本时，可以先打开域服务器中记事本之类的文本编辑工具，然后在编辑界面中输入下面的源代码：</p>
<p>@echo off<br>
start/wait \域服务器IP地址\aaa 111.exe<br>
start/wait \域服务器IP地址\aaa 222.exe<br>
……</p>
<p>其中“域服务器IP地址”其实就是保存有所有待安装程序的计算机IP地址，“aaa”表示保存有所有待安装程序的共享文件夹，111.exe、222.exe……表示待安装的具体应用程序名，“/wait”参数表示逐一地安装每一个应用程序，倘若没有这个参数的话，那么多个应用程序可能会出现同时安装的现象，这样容易造成安装混乱的现象。完成上面的代码输入后，单击文本编辑界面中的“文件”/“另存为”命令，在其后打开的文件保存对话框中，输入文件名“install.bat”，最后单击“保存”按钮，将上面的命令代码保存成批处理文件“install.bat”。</p>
<p>接着在域服务器系统桌面中，依次单击“开始”/“运行”命令，在随后打开的系统运行对话框中，输入字符串命令“DSA.MSC”，单击“确定”按钮后，打开一个标题为“Active Directory用户和计算机”的界面；用鼠标右键单击该界面左侧列表区域处的“ad.ycsti.cn”域服务器名称，从随后出现的右键菜单中单击“属性”命令，再在打开的属性设置框中单击一下“组策略”标签，在对应的标签页面中你将看到一些默认的组策略；下面你可以单击“新建”按钮，来重新创建一个新的组策略，并将该组策略的名字取为“批量安装程序”；随后再选中“批量安装程序”这个选项，并单击一下“编辑”按钮，打开具体的组策略编辑界面，该界面与单台工作站中的组策略编辑界面完全一样。依次展开组策略编辑界面中的“用户设置”、“Windows设置”、“脚本-（登录/注销）”分支，在对应“脚本-（登录/注销）”分支的右侧子窗口中，双击一下“登录”选项，在接着出现的如图1所示的对话框中，将前面创建的“INSTALL.BAT”批处理文件选中并导入进来。如果“INSTALL.BAT”批处理文件不在本地计算机的话，那么你不可以直接进入其他计算机的共享文件夹来选择，而必须通过网上邻居窗口来选择“INSTALL.BAT”批处理文件，这主要是因为工作站是通过网络方式访问“INSTALL.BAT”批处理文件的，所以必须将该批处理文件具体路径调整为网络路径。例如，要是“INSTALL.BAT”批处理文件保存在IP地址为“10.168.160.16”、共享文件夹名为“install”的工作站时，你就可以按照下面的步骤来选择并导入该文件了：先在IE浏览器地址框中输入“\10.168.160.16”，单击回车键后就能见到对应工作站中的所有共享文件夹；接着双击“install”共享文件夹图标，再在其后的界面中选中“INSTALL.BAT”，这样一来你就能在IE地址框中看到完整的网络路径了，以后再将该路径直接复制到图1所示的对话框中，并单击“确定”按钮就可以完成组策略的编辑操作了。<br>
<a href="http://daledeng.blog.163.com/album/prevPhoto.do?photoId=_fks_HThGygRRz7G4rrMNqRuNeO3WnTd_Ra_j"><img src="http://img.blog.163.com/photo/B4stcnT584j3gikoSED6Dw==/4513451251555449605.jpg" alt=""></a> 图1</p>
<p>要想实现应用程序的批量安装目的，还需要事先将所有需要在工作站中安装的应用程序全部保存到域服务器中，以便任何拥有域帐号的工作站可以自动从服务器中复制安装源程序。首先需要在域服务器中创建一个共享名为“aaa”的文件夹，然后再把所有待安装的应用程序全部复制到该文件夹中，或者将保存有待安装的应用程序所在的文件夹设置为共享，并且将共享名称设置为“aaa”。</p>
<p>为了确保工作站可以顺利登录到域服务器，你还需要事先在域服务器中为每一台工作站创建登录帐号，并将这些帐号全部添加到“Account Operators”组中。如果你的工作站还没有成为域成员的话，还必须进行下面的步骤：用鼠标右键单击“我的电脑”图标，从弹出的右键菜单中执行“属性”命令，在其后出现的属性设置框中，单击“计算机名”标签，再单击对应标签页面中的“属性”按钮，接着选中“隶属于”设置项处的“域”选项，在随后被激活的文本框中输入具体的域名称，例如这里应该输入“ad.ycsti.cn”（如图2所示），再单击“确定”按钮并重新启动一下计算机系统，以后你只要输入域用户名以及密码，顺利登录进域服务器中，工作站就能自动、批量地安装应用程序了。当然在为工作站批量安装好应用程序后，必须及时在域服务器的组策略设置界面中，删除“登录脚本”策略，不然的话工作站下次登录服务器时又将会重新安装以前的应用程序了。另外还要注意的是，工作站登录进域服务器的那个用户帐户还必须具有超级管理员权限才行。<br>
<a href="http://daledeng.blog.163.com/album/prevPhoto.do?photoId=_fks_kHitcsrEvXr1HJafVZjiKO7-Q88UFxzW"><img src="http://img.blog.163.com/photo/KRaFqbUqnzL54ERfIRq3yQ==/3970204546503920688.jpg" alt=""></a> 图2</p>
<p>小提示：普通工作站在登录域服务器时，常常可能出现无法登录域的错误提示，这种情况多数是你没有正确设置DNS服务器IP地址造成的。由于在默认状态下，网络服务器被升级为域服务器时，已经自动把自身配置成了DNS服务器，所以其他工作站在登录该服务器时，也必须将工作站的DNS服务器设置成域服务器的IP地址。</p>
<ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white white-70 dn dib-ns pv2 ph3 no-underline" href="/" >
    &copy;  Seth Dang博客 2025 
  </a>
    <div><div class="ananke-socials"></div>
</div>
  </div>
</footer>

  </body>
</html>
