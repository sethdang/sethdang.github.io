<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>bat的常用命令 | Seth Dang博客</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="echo、@、call、pause、rem(小技巧：用::代替rem)是批處理文件最常用的幾個命令，我們就從他們開始學起。
==== 注 ===========
首先, @ 不是一個命令, 而是DOS 批處理的一個特殊標記符, 僅用於屏蔽命令行回顯. 下面是DOS命令行或批處理中可能會見到的一些特殊標記符:
CR(0D) 命令行結束符
Escape(1B) ANSI轉義字符引導符
Space(20) 常用的參數界定符
Tab(09) ; = 不常用的參數界定符
&#43; COPY命令文件連接符

? 文件通配符
&quot;&quot; 字符串界定符
| 命令管道符
&lt; &gt; &raquo; 文件重定向符
@ 命令行回顯屏蔽符
/ 參數開關引導符
: 批處理標籤引導符
% 批處理變量引導符

其次, :: 確實可以起到rem 的註釋作用, 而且更簡潔有效; 但有兩點需要注意:
第一, 除了 :: 之外, 任何以 :開頭的字符行, 在批處理中都被視作標號, 而直接忽略其後的所有內容, 只是為了與正常的標號相區別, 建議使用 goto 所無法識別的標號, 即在 :後緊跟一個非字母數字的一個特殊符號.
第二, 與rem 不同的是, ::後的字符行在執行時不會回顯, 無論是否用echo on打開命令行回顯狀態, 因為命令解釋器不認為他是一個有效的命令行, 就此點來看, rem 在某些場合下將比 :: 更為適用; 另外, rem 可以用於 config.sys 文件中.
echo 表示顯示此命令後的字符
echo off 表示在此語句後所有運行的命令都不顯示命令行本身
@與echo off相像，但它是加在每個命令行的最前面，表示運行時不顯示這一行的命令行（只能影響當前行）。
call 調用另一個批處理文件（如果不用call而直接調用別的批處理文件，那麼執行完那個批處理文件後將無法返回當前文件並執行當前文件的後續命令）。
pause 運行此句會暫停批處理的執行並在屏幕上顯示Press any key to continue&hellip;的提示，等待用戶按任意鍵後繼續
rem 表示此命令後的字符為解釋行（註釋），不執行，只是給自己今後參考用的（相當於程序中的註釋）。
==== 注 =====
此處的描述較為混亂, 不如直接引用個命令的命令行幫助更為條理">
    <meta name="generator" content="Hugo 0.150.0">
    
    
    
      <meta name="robots" content="index, follow">
    
    <meta name="author" content="Seth">
    

    
<link rel="stylesheet" href="/ananke/css/main.min.2438bcafd7af9675c426d1a4afcd16cfff18e4e10f401071e45b5ccd3be40a0d.css" >




    


    
      

    

    

    
      <link rel="canonical" href="/posts/bat%E7%9A%84%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/">
    

    <meta property="og:url" content="/posts/bat%E7%9A%84%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/">
  <meta property="og:site_name" content="Seth Dang博客">
  <meta property="og:title" content="bat的常用命令">
  <meta property="og:description" content="echo、@、call、pause、rem(小技巧：用::代替rem)是批處理文件最常用的幾個命令，我們就從他們開始學起。
==== 注 ===========
首先, @ 不是一個命令, 而是DOS 批處理的一個特殊標記符, 僅用於屏蔽命令行回顯. 下面是DOS命令行或批處理中可能會見到的一些特殊標記符:
CR(0D) 命令行結束符
Escape(1B) ANSI轉義字符引導符
Space(20) 常用的參數界定符
Tab(09) ; = 不常用的參數界定符
&#43; COPY命令文件連接符
? 文件通配符
&#34;&#34; 字符串界定符
| 命令管道符
&lt; &gt; » 文件重定向符
@ 命令行回顯屏蔽符
/ 參數開關引導符
: 批處理標籤引導符
% 批處理變量引導符 其次, :: 確實可以起到rem 的註釋作用, 而且更簡潔有效; 但有兩點需要注意:
第一, 除了 :: 之外, 任何以 :開頭的字符行, 在批處理中都被視作標號, 而直接忽略其後的所有內容, 只是為了與正常的標號相區別, 建議使用 goto 所無法識別的標號, 即在 :後緊跟一個非字母數字的一個特殊符號.
第二, 與rem 不同的是, ::後的字符行在執行時不會回顯, 無論是否用echo on打開命令行回顯狀態, 因為命令解釋器不認為他是一個有效的命令行, 就此點來看, rem 在某些場合下將比 :: 更為適用; 另外, rem 可以用於 config.sys 文件中. echo 表示顯示此命令後的字符
echo off 表示在此語句後所有運行的命令都不顯示命令行本身
@與echo off相像，但它是加在每個命令行的最前面，表示運行時不顯示這一行的命令行（只能影響當前行）。
call 調用另一個批處理文件（如果不用call而直接調用別的批處理文件，那麼執行完那個批處理文件後將無法返回當前文件並執行當前文件的後續命令）。
pause 運行此句會暫停批處理的執行並在屏幕上顯示Press any key to continue…的提示，等待用戶按任意鍵後繼續
rem 表示此命令後的字符為解釋行（註釋），不執行，只是給自己今後參考用的（相當於程序中的註釋）。
==== 注 =====
此處的描述較為混亂, 不如直接引用個命令的命令行幫助更為條理">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2007-02-06T10:26:57+08:00">
    <meta property="article:modified_time" content="2007-02-06T10:26:57+08:00">

  <meta itemprop="name" content="bat的常用命令">
  <meta itemprop="description" content="echo、@、call、pause、rem(小技巧：用::代替rem)是批處理文件最常用的幾個命令，我們就從他們開始學起。
==== 注 ===========
首先, @ 不是一個命令, 而是DOS 批處理的一個特殊標記符, 僅用於屏蔽命令行回顯. 下面是DOS命令行或批處理中可能會見到的一些特殊標記符:
CR(0D) 命令行結束符
Escape(1B) ANSI轉義字符引導符
Space(20) 常用的參數界定符
Tab(09) ; = 不常用的參數界定符
&#43; COPY命令文件連接符
? 文件通配符
&#34;&#34; 字符串界定符
| 命令管道符
&lt; &gt; » 文件重定向符
@ 命令行回顯屏蔽符
/ 參數開關引導符
: 批處理標籤引導符
% 批處理變量引導符 其次, :: 確實可以起到rem 的註釋作用, 而且更簡潔有效; 但有兩點需要注意:
第一, 除了 :: 之外, 任何以 :開頭的字符行, 在批處理中都被視作標號, 而直接忽略其後的所有內容, 只是為了與正常的標號相區別, 建議使用 goto 所無法識別的標號, 即在 :後緊跟一個非字母數字的一個特殊符號.
第二, 與rem 不同的是, ::後的字符行在執行時不會回顯, 無論是否用echo on打開命令行回顯狀態, 因為命令解釋器不認為他是一個有效的命令行, 就此點來看, rem 在某些場合下將比 :: 更為適用; 另外, rem 可以用於 config.sys 文件中. echo 表示顯示此命令後的字符
echo off 表示在此語句後所有運行的命令都不顯示命令行本身
@與echo off相像，但它是加在每個命令行的最前面，表示運行時不顯示這一行的命令行（只能影響當前行）。
call 調用另一個批處理文件（如果不用call而直接調用別的批處理文件，那麼執行完那個批處理文件後將無法返回當前文件並執行當前文件的後續命令）。
pause 運行此句會暫停批處理的執行並在屏幕上顯示Press any key to continue…的提示，等待用戶按任意鍵後繼續
rem 表示此命令後的字符為解釋行（註釋），不執行，只是給自己今後參考用的（相當於程序中的註釋）。
==== 注 =====
此處的描述較為混亂, 不如直接引用個命令的命令行幫助更為條理">
  <meta itemprop="datePublished" content="2007-02-06T10:26:57+08:00">
  <meta itemprop="dateModified" content="2007-02-06T10:26:57+08:00">
  <meta itemprop="wordCount" content="1166">
  <meta itemprop="keywords" content="Softwave">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="bat的常用命令">
  <meta name="twitter:description" content="echo、@、call、pause、rem(小技巧：用::代替rem)是批處理文件最常用的幾個命令，我們就從他們開始學起。
==== 注 ===========
首先, @ 不是一個命令, 而是DOS 批處理的一個特殊標記符, 僅用於屏蔽命令行回顯. 下面是DOS命令行或批處理中可能會見到的一些特殊標記符:
CR(0D) 命令行結束符
Escape(1B) ANSI轉義字符引導符
Space(20) 常用的參數界定符
Tab(09) ; = 不常用的參數界定符
&#43; COPY命令文件連接符
? 文件通配符
&#34;&#34; 字符串界定符
| 命令管道符
&lt; &gt; » 文件重定向符
@ 命令行回顯屏蔽符
/ 參數開關引導符
: 批處理標籤引導符
% 批處理變量引導符 其次, :: 確實可以起到rem 的註釋作用, 而且更簡潔有效; 但有兩點需要注意:
第一, 除了 :: 之外, 任何以 :開頭的字符行, 在批處理中都被視作標號, 而直接忽略其後的所有內容, 只是為了與正常的標號相區別, 建議使用 goto 所無法識別的標號, 即在 :後緊跟一個非字母數字的一個特殊符號.
第二, 與rem 不同的是, ::後的字符行在執行時不會回顯, 無論是否用echo on打開命令行回顯狀態, 因為命令解釋器不認為他是一個有效的命令行, 就此點來看, rem 在某些場合下將比 :: 更為適用; 另外, rem 可以用於 config.sys 文件中. echo 表示顯示此命令後的字符
echo off 表示在此語句後所有運行的命令都不顯示命令行本身
@與echo off相像，但它是加在每個命令行的最前面，表示運行時不顯示這一行的命令行（只能影響當前行）。
call 調用另一個批處理文件（如果不用call而直接調用別的批處理文件，那麼執行完那個批處理文件後將無法返回當前文件並執行當前文件的後續命令）。
pause 運行此句會暫停批處理的執行並在屏幕上顯示Press any key to continue…的提示，等待用戶按任意鍵後繼續
rem 表示此命令後的字符為解釋行（註釋），不執行，只是給自己今後參考用的（相當於程序中的註釋）。
==== 注 =====
此處的描述較為混亂, 不如直接引用個命令的命令行幫助更為條理">

      
    
	
  </head><body class="ma0 avenir bg-near-white production">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l center items-center justify-between">
    <a href="/" class="f3 fw2 hover-white white-90 dib no-underline">
      
        Seth Dang博客
      
    </a>
    <div class="flex-l items-center">
      

      
      <div class="ananke-socials"></div>

    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  
  <article class="flex-l mw8 center ph3 flex-wrap justify-between">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Posts
      </aside><div id="sharing" class="mt3 ananke-socials"></div>
<h1 class="f1 athelas mt3 mb1">bat的常用命令</h1>
      
      <p class="tracked"><strong>Seth</strong>
      </p>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2007-02-06T10:26:57+08:00">February 6, 2007</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>echo、@、call、pause、rem(小技巧：用::代替rem)是批處理文件最常用的幾個命令，我們就從他們開始學起。</p>
<p>==== 注 ===========<br>
首先, @ 不是一個命令, 而是DOS 批處理的一個特殊標記符, 僅用於屏蔽命令行回顯. 下面是DOS命令行或批處理中可能會見到的一些特殊標記符:<br>
CR(0D) 命令行結束符<br>
Escape(1B) ANSI轉義字符引導符<br>
Space(20) 常用的參數界定符<br>
Tab(09) ; = 不常用的參數界定符<br>
+ COPY命令文件連接符</p>
<ul>
<li>? 文件通配符<br>
&quot;&quot; 字符串界定符<br>
| 命令管道符<br>
&lt; &gt; &raquo; 文件重定向符<br>
@ 命令行回顯屏蔽符<br>
/ 參數開關引導符<br>
: 批處理標籤引導符<br>
% 批處理變量引導符</li>
</ul>
<h1 id="第二-與rem-不同的是-後的字符行在執行時不會回顯-無論是否用echo-on打開命令行回顯狀態-因為命令解釋器不認為他是一個有效的命令行-就此點來看-rem-在某些場合下將比--更為適用-另外-rem-可以用於-configsys-文件中">其次, :: 確實可以起到rem 的註釋作用, 而且更簡潔有效; 但有兩點需要注意:<br>
第一, 除了 :: 之外, 任何以 :開頭的字符行, 在批處理中都被視作標號, 而直接忽略其後的所有內容, 只是為了與正常的標號相區別, 建議使用 goto 所無法識別的標號, 即在 :後緊跟一個非字母數字的一個特殊符號.<br>
第二, 與rem 不同的是, ::後的字符行在執行時不會回顯, 無論是否用echo on打開命令行回顯狀態, 因為命令解釋器不認為他是一個有效的命令行, 就此點來看, rem 在某些場合下將比 :: 更為適用; 另外, rem 可以用於 config.sys 文件中.</h1>
<p>echo 表示顯示此命令後的字符<br>
echo off 表示在此語句後所有運行的命令都不顯示命令行本身<br>
@與echo off相像，但它是加在每個命令行的最前面，表示運行時不顯示這一行的命令行（只能影響當前行）。<br>
call 調用另一個批處理文件（如果不用call而直接調用別的批處理文件，那麼執行完那個批處理文件後將無法返回當前文件並執行當前文件的後續命令）。<br>
pause 運行此句會暫停批處理的執行並在屏幕上顯示Press any key to continue&hellip;的提示，等待用戶按任意鍵後繼續<br>
rem 表示此命令後的字符為解釋行（註釋），不執行，只是給自己今後參考用的（相當於程序中的註釋）。<br>
==== 注 =====<br>
此處的描述較為混亂, 不如直接引用個命令的命令行幫助更為條理</p>
<p>-&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;<br>
ECHO</p>
<p>當程序運行時，顯示或隱藏批處理程序中的正文。也可用於允許或禁止命令的回顯。</p>
<p>在運行批處理程序時，MS-DOS一般在屏幕上顯示（回顯）批處理程序中的命令。<br>
使用ECHO命令可關閉此功能。</p>
<p>語法</p>
<p>ECHO [ON|OFF]</p>
<p>若要用echo命令顯示一條命令，可用下述語法：</p>
<p>echo [message]</p>
<p>參數</p>
<p>ON|OFF<br>
指定是否允許命令的回顯。若要顯示當前的ECHO的設置，可使用不帶參數的ECHO<br>
命令。</p>
<p>message<br>
指定讓MS-DOS在屏幕上顯示的正文。</p>
<p>-&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</p>
<p>CALL</p>
<p>從一個批處理程序中調用另一個批處理程序，而不會引起第一個批處理的中止。</p>
<p>語法</p>
<p>CALL [drive:][path]filename [batch-parameters]</p>
<p>參數</p>
<p>[drive:][path]filename<br>
指定要調用的批處理程序的名字及其存放處。文件名必須用.BAT作擴展名。</p>
<p>batch-parameters<br>
指定批處理程序所需的命令行信息。</p>
<p>-&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</p>
<p>PAUSE</p>
<p>暫停批處理程序的執行並顯示一條消息，提示用戶按任意鍵繼續執行。只能在批處<br>
理程序中使用該命令。</p>
<p>語法</p>
<p>PAUSE</p>
<p>REM</p>
<p>在批處理文件或CONFIG.SYS中加入註解。也可用REM命令來屏蔽命令（在CONFIG.SYS<br>
中也可以用分號 ; 代替REM命令，但在批處理文件中則不能替代）。</p>
<p>語法</p>
<p>REM [string]</p>
<p>參數</p>
<h1 id="指定要屏蔽的命令或要包含的註解">string<br>
指定要屏蔽的命令或要包含的註解。</h1>
<p>例1：用edit編輯a.bat文件，輸入下列內容後存盤為c:\a.bat，執行該批處理文件後可實現：將根目錄中所有文件寫入 a.txt中，啟動UCDOS，進入WPS等功能。</p>
<p>批處理文件的內容為: 命令註釋：</p>
<p>@echo off 不顯示後續命令行及當前命令行<br>
dir c:\<em>.</em> &gt;a.txt 將c盤文件列表寫入a.txt<br>
call c:\ucdos\ucdos.bat 調用ucdos<br>
echo 你好 顯示&quot;你好&quot;<br>
pause 暫停,等待按鍵繼續<br>
rem 準備運行wps 註釋：準備運行wps<br>
cd ucdos 進入ucdos目錄<br>
wps 運行wps</p>
<p>批處理文件的參數</p>
<p>批處理文件還可以像C語言的函數一樣使用參數（相當於DOS命令的命令行參數），這需要用到一個參數表示符&quot;%&quot;。</p>
<p>%[1-9]表示參數，參數是指在運行批處理文件時在文件名後加的以空格（或者Tab）分隔的字符串。變量可以從%0到%9，%0表示批處理命令本身，其它參數字符串用%1到%9順序表示。</p>
<p>例2：C:根目錄下有一批處理文件名為f.bat，內容為：<br>
@echo off<br>
format %1</p>
<p>如果執行C:&gt;f a:<br>
那麼在執行f.bat時，%1就表示a:，這樣format %1就相當於format a:，於是上面的命令運行時實際執行的是format a:</p>
<p>例3：C:根目錄下一批處理文件名為t.bat，內容為:<br>
@echo off<br>
type %1<br>
type %2</p>
<p>那麼運行C:&gt;t a.txt b.txt<br>
%1 : 表示a.txt<br>
%2 : 表示b.txt<br>
於是上面的命令將順序地顯示a.txt和b.txt文件的內容。</p>
<p>==== 注 ===============<br>
參數在批處理中也作為變量處理, 所以同樣使用百分號作為引導符, 其後跟0-9中的一個數字構成參數引用符. 引用符和參數之間 (例如上文中的 %1 與 a: ) 的關係類似於變量指針與變量值的關係. 當我們要引用第十一個或更多個參數時, 就必須移動DOS 的參數起始指針. shift 命令正充當了這個移動指針的角色, 它將參數的起始指針移動到下一個參數, 類似C 語言中的指針操作. 圖示如下:</p>
<p>初始狀態, cmd 為命令名, 可以用 %0 引用<br>
cmd arg1 arg2 arg3 arg4 arg5 arg6 arg7 arg8 arg9 arg10<br>
^ ^ ^ ^ ^ ^ ^ ^ ^ ^<br>
| | | | | | | | | |<br>
%0 %1 %2 %3 %4 %5 %6 %7 %8 %9</p>
<p>經過1次shift後, cmd 將無法被引用<br>
cmd arg1 arg2 arg3 arg4 arg5 arg6 arg7 arg8 arg9 arg10<br>
^ ^ ^ ^ ^ ^ ^ ^ ^ ^<br>
| | | | | | | | | |<br>
%0 %1 %2 %3 %4 %5 %6 %7 %8 %9</p>
<p>經過2次shift後, arg1也被廢棄, %9指向為空, 沒有引用意義<br>
cmd arg1 arg2 arg3 arg4 arg5 arg6 arg7 arg8 arg9 arg10<br>
^ ^ ^ ^ ^ ^ ^ ^ ^<br>
| | | | | | | | |<br>
%0 %1 %2 %3 %4 %5 %6 %7 %8</p>
<h1 id="遺憾的是-win9x-和dos下均不支持-shift-的逆操作-只有在-nt-內核命令行環境下-shift-才支持-n-參數-可以以第一參數為基準返復移動起始指針">遺憾的是, win9x 和DOS下均不支持 shift 的逆操作. 只有在 nt 內核命令行環境下, shift 才支持 /n 參數, 可以以第一參數為基準返復移動起始指針.</h1>
<p>特殊命令</p>
<p>if goto choice for是批處理文件中比較高級的命令，如果這幾個你用得很熟練，你就是批處理文件的專家啦。</p>
<p>一、if 是條件語句，用來判斷是否符合規定的條件，從而決定執行不同的命令。 有三種格式:</p>
<p>1、if [not] &ldquo;參數&rdquo; == &ldquo;字符串&rdquo; 待執行的命令</p>
<p>參數如果等於(not表示不等，下同)指定的字符串，則條件成立，運行命令，否則運行下一句。</p>
<p>例：if &ldquo;%1&rdquo;==&ldquo;a&rdquo; format a:</p>
<p>====</p>
<h1 id="3-command-不是語法所必須的-string2-後跟一個空格就可以構成一個有效的命令行">if 的命令行幫助中關於此點的描述為:<br>
IF [NOT] string1==string2 command<br>
在此有以下幾點需要注意:<br>
1. 包含字符串的雙引號不是語法所必須的, 而只是習慣上使用的一種&quot;防空&quot;字符<br>
2. string1 未必是參數, 它也可以是環境變量, 循環變量以及其他字符串常量或變量<br>
3. command 不是語法所必須的, string2 後跟一個空格就可以構成一個有效的命令行</h1>
<p>2、if [not] exist [路徑\]文件名 待執行的命令<br>
如果有指定的文件，則條件成立，運行命令，否則運行下一句。</p>
<p>如: if exist c:\config.sys type c:\config.sys<br>
表示如果存在c:\config.sys文件，則顯示它的內容。</p>
<h1 id="另外-在dos系統中-設備也被認為是一種特殊的文件-而文件也可以稱作字符設備-因為設備device與文件都是使用句柄handle來管理的-句柄就是名字-類似於文件名-只不過句柄不是應用於磁盤管理-而是應用於內存管理而已-所謂設備加載也即指在內存中為其分配可引用的句柄">****** 注 ********<br>
也可以使用以下的用法:<br>
if exist command<br>
device 是指DOS系統中已加載的設備, 在win98下通常有:<br>
AUX, PRN, CON, NUL<br>
COM1, COM2, COM3, COM4<br>
LPT1, LPT2, LPT3, LPT4<br>
XMSXXXX0, EMMXXXX0<br>
A: B: C: &hellip;,<br>
CLOCK$, CONFIG$, DblBuff$, IFS$HLP$<br>
具體的內容會因硬軟件環境的不同而略有差異, 使用這些設備名稱時, 需要保證以下三點:<br>
1. 該設備確實存在(由軟件虛擬的設備除外)<br>
2. 該設備驅動程序已加載(aux, prn等標準設備由系統缺省定義)<br>
3. 該設備已準備好(主要是指a: b: &hellip;, com1&hellip;, lpt1&hellip;等)<br>
可通過命令 mem/d | find &ldquo;device&rdquo; /i 來檢閱你的系統中所加載的設備<br>
另外, 在DOS系統中, 設備也被認為是一種特殊的文件, 而文件也可以稱作字符設備; 因為設備(device)與文件都是使用句柄(handle)來管理的, 句柄就是名字, 類似於文件名, 只不過句柄不是應用於磁盤管理, 而是應用於內存管理而已, 所謂設備加載也即指在內存中為其分配可引用的句柄.</h1>
<p>3、if errorlevel &lt;數字&gt; 待執行的命令</p>
<p>很多DOS程序在運行結束後會返回一個數字值用來表示程序運行的結果(或者狀態)，通過if errorlevel命令可以判斷程序的返回值，根據不同的返回值來決定執行不同的命令(返回值必須按照從大到小的順序排列)。如果返回值等於指定的數字，則條件成立，運行命令，否則運行下一句。</p>
<p>如if errorlevel 2 goto x2</p>
<p>==== 注 ===========<br>
返回值從大到小的順序排列不是必須的, 而只是執行命令為 goto 時的習慣用法, 當使用 set 作為執行命令時, 通常會從小到大順序排列, 比如需將返回碼置入環境變量, 就需使用以下的順序形式:</p>
<p>if errorlevel 1 set el=1<br>
if errorlevel 2 set el=2<br>
if errorlevel 3 set el=3<br>
if errorlevel 4 set el=4<br>
if errorlevel 5 set el=5<br>
&hellip;</p>
<p>當然, 也可以使用以下循環來替代, 原理是一致的:<br>
for %%e in (1 2 3 4 5 6 7 8&hellip;) do if errorlevel %%e set el=%%e</p>
<p>出現此種現象的原因是, if errorlevel 比較返回碼的判斷條件並非等於, 而是大於等於. 由於 goto 的跳轉特性, 由小到大排序會導致在較小的返回碼處就跳出; 而由於 set命令的 &ldquo;重複&rdquo; 賦值特性, 由大到小排序會導致較小的返回碼 &ldquo;覆蓋&rdquo; 較大的返回碼.</p>
<h1 id="另外-雖然-if-errorlevel數字-command-也是有效的命令行-但也只是-commandcom-解釋命令行時將--作為命令行切分符而忽略掉罷了">另外, 雖然 if errorlevel=&lt;數字&gt; command 也是有效的命令行, 但也只是 command.com 解釋命令行時將 = 作為命令行切分符而忽略掉罷了</h1>
<p>二、goto 批處理文件運行到這裡將跳到goto所指定的標號(標號即label，標號用:後跟標準字符串來定義)處，goto語句一般與if配合使用，根據不同的條件來執行不同的命令組。</p>
<p>如:</p>
<p>goto end</p>
<p>:end<br>
echo this is the end</p>
<p>標號用&quot;:字符串&quot;來定義，標號所在行不被執行。</p>
<p>==== willsort 編注</p>
<p>label 常被譯為 &ldquo;標籤&rdquo; , 但是這並不具有廣泛的約定性.</p>
<p>goto 與 : 聯用可實現執行中途的跳轉, 再結合 if 可實現執行過程的條件分支, 多個 if 即可實現命令的分組, 類似 C 中 switch case 結構或者 Basic 中的 select case 結構, 大規模且結構化的命令分組即可實現高級語言中的函數功能. 以下是批處理和C/Basic在語法結構上的對照:</p>
<h1 id="gotoifsetenvar-function--functionsub">Batch C / Basic<br>
goto&amp;: goto&amp;:<br>
goto&amp;:&amp;if; if{}&amp;else;{} / if&amp;elseif;&amp;endif;<br>
goto&amp;:&amp;if&hellip;; switch&amp;case; / select case<br>
goto&amp;:&amp;if;&amp;set;&amp;envar&hellip;; function() / function(),sub()</h1>
<p>三、choice 使用此命令可以讓用戶輸入一個字符（用於選擇），從而根據用戶的選擇返回不同的errorlevel，然後於if errorlevel配合，根據用戶的選擇運行不同的命令。</p>
<p>注意：choice命令為DOS或者Windows系統提供的外部命令，不同版本的choice命令語法會稍有不同，請用choice /?查看用法。</p>
<p>choice的命令語法（該語法為Windows 2003中choice命令的語法，其它版本的choice的命令語法與此大同小異）：</p>
<p>CHOICE [/C choices] [/N] [/CS] [/T timeout /D choice] [/M text]</p>
<p>描述:<br>
該工具允許用戶從選擇列表選擇一個項目並返回所選項目的索引。</p>
<p>參數列表:<br>
/C choices 指定要創建的選項列表。默認列表是 &ldquo;YN&rdquo;。</p>
<p>/N 在提示符中隱藏選項列表。提示前面的消息得到顯示，<br>
選項依舊處於啟用狀態。</p>
<p>/CS 允許選擇分大小寫的選項。在默認情況下，這個工具<br>
是不分大小寫的。</p>
<p>/T timeout 做出默認選擇之前，暫停的秒數。可接受的值是從 0<br>
到 9999。如果指定了 0，就不會有暫停，默認選項<br>
會得到選擇。</p>
<p>/D choice 在 nnnn 秒之後指定默認選項。字符必須在用 /C 選<br>
項指定的一組選擇中; 同時，必須用 /T 指定 nnnn。</p>
<p>/M text 指定提示之前要顯示的消息。如果沒有指定，工具只<br>
顯示提示。</p>
<p>/? 顯示幫助消息。</p>
<p>注意:<br>
ERRORLEVEL 環境變量被設置為從選擇集選擇的鍵索引。列出的第一個選<br>
擇返回 1，第二個選擇返回 2，等等。如果用戶按的鍵不是有效的選擇，<br>
該工具會發出警告響聲。如果該工具檢測到錯誤狀態，它會返回 255 的<br>
ERRORLEVEL 值。如果用戶按 Ctrl+Break 或 Ctrl+C 鍵，該工具會返回 0<br>
的 ERRORLEVEL 值。在一個批程序中使用 ERRORLEVEL 參數時，將參數降<br>
序排列。</p>
<p>示例:<br>
CHOICE /?<br>
CHOICE /C YNC /M &ldquo;確認請按 Y，否請按 N，或者取消請按 C。&rdquo;<br>
CHOICE /T 10 /C ync /CS /D y<br>
CHOICE /C ab /M &ldquo;選項 1 請選擇 a，選項 2 請選擇 b。&rdquo;<br>
CHOICE /C ab /N /M &ldquo;選項 1 請選擇 a，選項 2 請選擇 b。&rdquo;</p>
<p>==== willsort 編注 ===============================<br>
我列出win98下choice的用法幫助, 已資區分</p>
<p>Waits for the user to choose one of a set of choices.<br>
等待用戶選擇一組待選字符中的一個</p>
<p>CHOICE [/C[:]choices] [/N] [/S] [/T[:]c,nn] [text]</p>
<p>/C[:]choices Specifies allowable keys. Default is YN<br>
指定允許的按鍵(待選字符), 默認為YN<br>
/N Do not display choices and ? at end of prompt string.<br>
不顯示提示字符串中的問號和待選字符<br>
/S Treat choice keys as case sensitive.<br>
處理待選字符時大小寫敏感<br>
/T[:]c,nn Default choice to c after nn seconds<br>
在 nn 秒後默認選擇 c<br>
text Prompt string to display<br>
要顯示的提示字符串<br>
ERRORLEVEL is set to offset of key user presses in choices.<br>
ERRORLEVEL 被設置為用戶鍵入的字符在待選字符中的偏移值<br>
如果我運行命令：CHOICE /C YNC /M &ldquo;確認請按 Y，否請按 N，或者取消請按 C。&rdquo;<br>
屏幕上會顯示：<br>
確認請按 Y，否請按 N，或者取消請按 C。 [Y,N,C]?</p>
<p>例：test.bat的內容如下（注意，用if errorlevel判斷返回值時，要按返回值從高到低排列）:<br>
@echo off<br>
choice /C dme /M &ldquo;defrag,mem,end&rdquo;<br>
if errorlevel 3 goto end<br>
if errorlevel 2 goto mem<br>
if errorlevel 1 goto defrag</p>
<p>:defrag<br>
c:\dos\defrag<br>
goto end</p>
<p>:mem<br>
mem<br>
goto end</p>
<p>:end<br>
echo good bye</p>
<p>此批處理運行後，將顯示&quot;defrag,mem,end[D,M,E]?&quot; ，用戶可選擇d m e ，然後if語句根據用戶的選擇作出判斷，d表示執行標號為defrag的程序段，m表示執行標號為mem的程序段，e表示執行標號為end的程序段，每個程序段最後都以goto end將程序跳到end標號處，然後程序將顯示good bye，批處理運行結束。</p>
<p>四、for 循環命令，只要條件符合，它將多次執行同一命令。</p>
<p>語法：<br>
對一組文件中的每一個文件執行某個特定命令。</p>
<p>FOR %%variable IN (set) DO command [command-parameters]</p>
<p>%%variable 指定一個單一字母可替換的參數。<br>
(set) 指定一個或一組文件。可以使用通配符。<br>
command 指定對每個文件執行的命令。<br>
command-parameters<br>
為特定命令指定參數或命令行開關。</p>
<p>例如一個批處理文件中有一行:<br>
for %%c in (*.bat *.txt) do type %%c</p>
<p>則該命令行會顯示當前目錄下所有以bat和txt為擴展名的文件的內容。</p>
<h1 id="當然-在-nt2000xp2003-系列的命令行環境中-for-被賦予了更多的特性-使之可以分析命令輸出或者文件中的字符串-也有很多開關被用於擴展了文件替換功能">==== willsort 編注 =====================================================<br>
需要指出的是, 當()中的字符串並非單個或多個文件名時, 它將單純被當作字符串替換, 這個特性再加上()中可以嵌入多個字符串的特性, 很明顯 for 可以被看作一種遍歷型循環.<br>
當然, 在 nt/2000/xp/2003 系列的命令行環境中, for 被賦予了更多的特性, 使之可以分析命令輸出或者文件中的字符串, 也有很多開關被用於擴展了文件替換功能.</h1>
<p>批處理示例</p>
<p>1. IF-EXIST</p>
<ol>
<li>首先用記事本在C:\建立一個test1.bat批處理文件，文件內容如下：<br>
@echo off<br>
IF EXIST \AUTOEXEC.BAT TYPE \AUTOEXEC.BAT<br>
IF NOT EXIST \AUTOEXEC.BAT ECHO \AUTOEXEC.BAT does not exist</li>
</ol>
<p>然後運行它：<br>
C:&gt;TEST1.BAT</p>
<p>如果C:\存在AUTOEXEC.BAT文件，那麼它的內容就會被顯示出來，如果不存在，批處理就會提示你該文件不存在。</p>
<ol start="2">
<li>接著再建立一個test2.bat文件，內容如下：<br>
@ECHO OFF<br>
IF EXIST %1 TYPE %1<br>
IF NOT EXIST %1 ECHO %1 does not exist</li>
</ol>
<p>執行:<br>
C:&gt;TEST2 AUTOEXEC.BAT<br>
該命令運行結果同上。</p>
<p>說明：<br>
(1) IF EXIST 是用來測試文件是否存在的，格式為<br>
IF EXIST [路徑+文件名] 命令<br>
(2) test2.bat文件中的%1是參數，DOS允許傳遞9個批參數信息給批處理文件，分別為%1~%9(%0表示test2命令本身) ，這有點像編程中的實參和形參的關係，%1是形參，AUTOEXEC.BAT是實參。</p>
<h1 id="dos沒有-允許傳遞9個批參數信息-的限制-參數的個數只會受到命令行長度和所調用命令處理能力的限制-但是-我們在批處理程序中-在同一時刻只能同時引用10個參數-因為-dos只給出了-09這十個參數引用符">==== willsort 編注 =====================================================<br>
DOS沒有 &ldquo;允許傳遞9個批參數信息&rdquo; 的限制, 參數的個數只會受到命令行長度和所調用命令處理能力的限制. 但是, 我們在批處理程序中, 在同一時刻只能同時引用10個參數, 因為 DOS只給出了 %0~%9這十個參數引用符.</h1>
<ol start="3">
<li>更進一步的，建立一個名為TEST3.BAT的文件，內容如下：<br>
@echo off<br>
IF &ldquo;%1&rdquo; == &ldquo;A&rdquo; ECHO XIAO<br>
IF &ldquo;%2&rdquo; == &ldquo;B&rdquo; ECHO TIAN<br>
IF &ldquo;%3&rdquo; == &ldquo;C&rdquo; ECHO XIN</li>
</ol>
<p>如果運行：<br>
C:&gt;TEST3 A B C<br>
屏幕上會顯示:<br>
XIAO<br>
TIAN<br>
XIN</p>
<p>如果運行：<br>
C:&gt;TEST3 A B<br>
屏幕上會顯示<br>
XIAO<br>
TIAN</p>
<p>在這個命令執行過程中，DOS會將一個空字符串指定給參數%3。</p>
<p>2、IF-ERRORLEVEL</p>
<p>建立TEST4.BAT，內容如下：<br>
@ECHO OFF<br>
XCOPY C:\AUTOEXEC.BAT D:\<br>
IF ERRORLEVEL 1 ECHO 文件拷貝失敗<br>
IF ERRORLEVEL 0 ECHO 成功拷貝文件</p>
<p>然後執行文件:<br>
C:&gt;TEST4</p>
<p>如果文件拷貝成功，屏幕就會顯示&quot;成功拷貝文件&quot;，否則就會顯示&quot;文件拷貝失敗&quot;。</p>
<p>IF ERRORLEVEL 是用來測試它的上一個DOS命令的返回值的，注意只是上一個命令的返回值，而且返回值必須依照從大到小次序順序判斷。<br>
因此下面的批處理文件是錯誤的：</p>
<p>@ECHO OFF<br>
XCOPY C:\AUTOEXEC.BAT D:\<br>
IF ERRORLEVEL 0 ECHO 成功拷貝文件<br>
IF ERRORLEVEL 1 ECHO 未找到拷貝文件<br>
IF ERRORLEVEL 2 ECHO 用戶通過ctrl-c中止拷貝操作<br>
IF ERRORLEVEL 3 ECHO 預置錯誤阻止文件拷貝操作<br>
IF ERRORLEVEL 4 ECHO 拷貝過程中寫盤錯誤</p>
<p>無論拷貝是否成功，後面的：</p>
<p>未找到拷貝文件<br>
用戶通過ctrl-c中止拷貝操作<br>
預置錯誤阻止文件拷貝操作<br>
拷貝過程中寫盤錯誤</p>
<p>都將顯示出來。</p>
<p>以下就是幾個常用命令的返回值及其代表的意義：</p>
<p>backup<br>
0 備份成功<br>
1 未找到備份文件<br>
2 文件共享衝突阻止備份完成<br>
3 用戶用ctrl-c中止備份<br>
4 由於致命的錯誤使備份操作中止</p>
<p>diskcomp<br>
0 盤比較相同<br>
1 盤比較不同<br>
2 用戶通過ctrl-c中止比較操作<br>
3 由於致命的錯誤使比較操作中止<br>
4 預置錯誤中止比較</p>
<p>diskcopy<br>
0 盤拷貝操作成功<br>
1 非致命盤讀/寫錯<br>
2 用戶通過ctrl-c結束拷貝操作<br>
3 因致命的處理錯誤使盤拷貝中止<br>
4 預置錯誤阻止拷貝操作</p>
<p>format<br>
0 格式化成功<br>
3 用戶</p>
<ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white white-70 dn dib-ns pv2 ph3 no-underline" href="/" >
    &copy;  Seth Dang博客 2025 
  </a>
    <div><div class="ananke-socials"></div>
</div>
  </div>
</footer>

  </body>
</html>
