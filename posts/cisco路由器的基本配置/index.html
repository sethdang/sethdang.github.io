<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>cisco路由器的基本配置  | Seth Dang博客</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="1 ． 配 置 以 太 網（Ethernet） 端 口：
conf t
從終端配置路由器。
int e0
指定E0口。
ip addr ABCD XXXX
ABCD為以太網地址,XXXX為子網掩碼。
ip addr ABCD XXXX secondary
E0口同時支持兩個地址類型。如果第一個
為A類地址，則第二個為B或C類地址。
no shutdown
激活E0口。
exit
2．X.25的配置
conf t
int S0
指定S0口.
ip addr ABCD XXXX
ABCD為以太網S0的IP地址,XXXX為子網掩碼.。
encap X25-ABC
封裝X.25協議。ABC指定X.25為DTC或DCE操作，缺省為DTE。
x25 addr ABCD
ABCD為S0的X.25端口地址,由郵電局提供。
x25 map ip ABCD XXXX br
映射的X.25地址.ABCD為對方路由器(如:S0)的
IP地址,XXXX為對方路由器(如:S0)的X.25端口地址。
x25 htc X
配置最高雙向通道數.X的取值範圍1-4095,
要根據郵電局實際提供的數字配置。
x25 nvc X
配置虛電路數。X不可超過據郵電局實際
提供的數,否則,將影響數據的正常傳輸。
exit
-&mdash; 3 ． 專 線 的 配 置：">
    <meta name="generator" content="Hugo 0.150.0">
    
    
    
      <meta name="robots" content="index, follow">
    
    <meta name="author" content="Seth">
    

    
<link rel="stylesheet" href="/ananke/css/main.min.2438bcafd7af9675c426d1a4afcd16cfff18e4e10f401071e45b5ccd3be40a0d.css" >




    


    
      

    

    

    
      <link rel="canonical" href="/posts/cisco%E8%B7%AF%E7%94%B1%E5%99%A8%E7%9A%84%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/">
    

    <meta property="og:url" content="/posts/cisco%E8%B7%AF%E7%94%B1%E5%99%A8%E7%9A%84%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/">
  <meta property="og:site_name" content="Seth Dang博客">
  <meta property="og:title" content="cisco路由器的基本配置 ">
  <meta property="og:description" content="1 ． 配 置 以 太 網（Ethernet） 端 口：
conf t 從終端配置路由器。
int e0 指定E0口。
ip addr ABCD XXXX ABCD為以太網地址,XXXX為子網掩碼。
ip addr ABCD XXXX secondary E0口同時支持兩個地址類型。如果第一個
為A類地址，則第二個為B或C類地址。
no shutdown 激活E0口。
exit 2．X.25的配置
conf t int S0 指定S0口.
ip addr ABCD XXXX ABCD為以太網S0的IP地址,XXXX為子網掩碼.。
encap X25-ABC 封裝X.25協議。ABC指定X.25為DTC或DCE操作，缺省為DTE。
x25 addr ABCD ABCD為S0的X.25端口地址,由郵電局提供。
x25 map ip ABCD XXXX br 映射的X.25地址.ABCD為對方路由器(如:S0)的
IP地址,XXXX為對方路由器(如:S0)的X.25端口地址。
x25 htc X 配置最高雙向通道數.X的取值範圍1-4095,
要根據郵電局實際提供的數字配置。
x25 nvc X 配置虛電路數。X不可超過據郵電局實際
提供的數,否則,將影響數據的正常傳輸。
exit -— 3 ． 專 線 的 配 置：">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2007-03-28T14:30:16+08:00">
    <meta property="article:modified_time" content="2007-03-28T14:30:16+08:00">

  <meta itemprop="name" content="cisco路由器的基本配置 ">
  <meta itemprop="description" content="1 ． 配 置 以 太 網（Ethernet） 端 口：
conf t 從終端配置路由器。
int e0 指定E0口。
ip addr ABCD XXXX ABCD為以太網地址,XXXX為子網掩碼。
ip addr ABCD XXXX secondary E0口同時支持兩個地址類型。如果第一個
為A類地址，則第二個為B或C類地址。
no shutdown 激活E0口。
exit 2．X.25的配置
conf t int S0 指定S0口.
ip addr ABCD XXXX ABCD為以太網S0的IP地址,XXXX為子網掩碼.。
encap X25-ABC 封裝X.25協議。ABC指定X.25為DTC或DCE操作，缺省為DTE。
x25 addr ABCD ABCD為S0的X.25端口地址,由郵電局提供。
x25 map ip ABCD XXXX br 映射的X.25地址.ABCD為對方路由器(如:S0)的
IP地址,XXXX為對方路由器(如:S0)的X.25端口地址。
x25 htc X 配置最高雙向通道數.X的取值範圍1-4095,
要根據郵電局實際提供的數字配置。
x25 nvc X 配置虛電路數。X不可超過據郵電局實際
提供的數,否則,將影響數據的正常傳輸。
exit -— 3 ． 專 線 的 配 置：">
  <meta itemprop="datePublished" content="2007-03-28T14:30:16+08:00">
  <meta itemprop="dateModified" content="2007-03-28T14:30:16+08:00">
  <meta itemprop="wordCount" content="2757">
  <meta itemprop="keywords" content="Network">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="cisco路由器的基本配置 ">
  <meta name="twitter:description" content="1 ． 配 置 以 太 網（Ethernet） 端 口：
conf t 從終端配置路由器。
int e0 指定E0口。
ip addr ABCD XXXX ABCD為以太網地址,XXXX為子網掩碼。
ip addr ABCD XXXX secondary E0口同時支持兩個地址類型。如果第一個
為A類地址，則第二個為B或C類地址。
no shutdown 激活E0口。
exit 2．X.25的配置
conf t int S0 指定S0口.
ip addr ABCD XXXX ABCD為以太網S0的IP地址,XXXX為子網掩碼.。
encap X25-ABC 封裝X.25協議。ABC指定X.25為DTC或DCE操作，缺省為DTE。
x25 addr ABCD ABCD為S0的X.25端口地址,由郵電局提供。
x25 map ip ABCD XXXX br 映射的X.25地址.ABCD為對方路由器(如:S0)的
IP地址,XXXX為對方路由器(如:S0)的X.25端口地址。
x25 htc X 配置最高雙向通道數.X的取值範圍1-4095,
要根據郵電局實際提供的數字配置。
x25 nvc X 配置虛電路數。X不可超過據郵電局實際
提供的數,否則,將影響數據的正常傳輸。
exit -— 3 ． 專 線 的 配 置：">

      
    
	
  </head><body class="ma0 avenir bg-near-white production">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l center items-center justify-between">
    <a href="/" class="f3 fw2 hover-white white-90 dib no-underline">
      
        Seth Dang博客
      
    </a>
    <div class="flex-l items-center">
      

      
      <div class="ananke-socials"></div>

    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  
  <article class="flex-l mw8 center ph3 flex-wrap justify-between">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Posts
      </aside><div id="sharing" class="mt3 ananke-socials"></div>
<h1 class="f1 athelas mt3 mb1">cisco路由器的基本配置 </h1>
      
      <p class="tracked"><strong>Seth</strong>
      </p>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2007-03-28T14:30:16+08:00">March 28, 2007</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>1 ． 配 置 以 太 網（Ethernet） 端 口：</p>
<h1 id="conf-t">conf t</h1>
<p>從終端配置路由器。</p>
<h1 id="int-e0">int e0</h1>
<p>指定E0口。</p>
<h1 id="ip-addr-abcd-xxxx">ip addr ABCD XXXX</h1>
<p>ABCD為以太網地址,XXXX為子網掩碼。</p>
<h1 id="ip-addr-abcd-xxxx-secondary">ip addr ABCD XXXX secondary</h1>
<p>E0口同時支持兩個地址類型。如果第一個<br>
為A類地址，則第二個為B或C類地址。</p>
<h1 id="no-shutdown">no shutdown</h1>
<p>激活E0口。</p>
<h1 id="exit">exit</h1>
<p>2．X.25的配置</p>
<h1 id="conf-t-1">conf t</h1>
<h1 id="int-s0">int S0</h1>
<p>指定S0口.</p>
<h1 id="ip-addr-abcd-xxxx-1">ip addr ABCD XXXX</h1>
<p>ABCD為以太網S0的IP地址,XXXX為子網掩碼.。</p>
<h1 id="encap-x25-abc">encap X25-ABC</h1>
<p>封裝X.25協議。ABC指定X.25為DTC或DCE操作，缺省為DTE。</p>
<h1 id="x25-addr-abcd">x25 addr ABCD</h1>
<p>ABCD為S0的X.25端口地址,由郵電局提供。</p>
<h1 id="x25-map-ip-abcd-xxxx-br">x25 map ip ABCD XXXX br</h1>
<p>映射的X.25地址.ABCD為對方路由器(如:S0)的<br>
IP地址,XXXX為對方路由器(如:S0)的X.25端口地址。</p>
<h1 id="x25-htc-x">x25 htc X</h1>
<p>配置最高雙向通道數.X的取值範圍1-4095,<br>
要根據郵電局實際提供的數字配置。</p>
<h1 id="x25-nvc-x">x25 nvc X</h1>
<p>配置虛電路數。X不可超過據郵電局實際<br>
提供的數,否則,將影響數據的正常傳輸。</p>
<h1 id="exit-1">exit</h1>
<p>-&mdash; 3 ． 專 線 的 配 置：</p>
<h1 id="conf-t-2">conf t</h1>
<h1 id="int-s2">int S2</h1>
<p>指定S2口。</p>
<h1 id="ip-addr-abcd-xxxx-2">ip addr ABCD XXXX</h1>
<p>ABCD為S2的IP地址,XXXX為子網掩碼。</p>
<h1 id="exit-2">exit</h1>
<p>4．幀中繼的配置</p>
<h1 id="conf-t-3">conf t</h1>
<h1 id="int-s0-1">int s0</h1>
<h1 id="ip-addr-abcd-xxxx-3">ip addr ABCD XXXX</h1>
<p>ABCD為S0的IP地址,XXXX為子網掩碼。</p>
<h1 id="encap-frante_relay">encap frante_relay</h1>
<p>封裝frante_relay協議。</p>
<h1 id="no-nrzi_encoding">no nrzi_encoding</h1>
<p>NRZI=NO</p>
<h1 id="frame_relay-lmi_type-q933a">frame_relay lmi_type q933a</h1>
<p>LMI使用Q933A標準．LMI（Local management Interface）有3種：ANSI：T1.617；CCITTY：Q933A和CISCO特有的標準。</p>
<h1 id="fram-relay-intf-typ-abc">fram-relay intf-typ ABC</h1>
<p>ABC為幀中繼設備類型，它們分別是DTE設備，DCE交換機或NNI（網絡接點接口）支持。</p>
<h1 id="frame_relay-interface_dlci-110-br">frame_relay interface_dlci 110 br</h1>
<p>配置DLCI(數據鏈路連接標識符)。</p>
<h1 id="frame-relay-map-ip-abcd-xxxx-broadcast">frame-relay map ip ABCD XXXX broadcast</h1>
<p>建立幀中繼映射。ABCD為對方ip地址，XXXX為本地DLCI號，broadcast允許廣播向前轉發或更新路由。</p>
<h1 id="no-shutdown-1">no shutdown</h1>
<p>激活本端口．</p>
<h1 id="exit-3">exit</h1>
<p>-&mdash; 5 ． 幀 中 繼 子 接 口 的 配 置：</p>
<h1 id="conf-ｔ">conf ｔ</h1>
<h1 id="int-s01-point-to-point">int s0.1 point-to-point</h1>
<p>對應S0的子接口1，點對點方式。</p>
<h1 id="ip-addr-abcd-xxxx-4">ip addr ABCD XXXX</h1>
<p>ABCD為子口1的IP地址,XXXX為子網掩碼。</p>
<h1 id="frame-relay-intreface-dlci-100-br">frame-relay intreface-dlci 100 br</h1>
<p>6．配置撥號備份<br>
(1)．配置備份主口</p>
<h1 id="conf-t-4">conf t</h1>
<h1 id="int-s0-2">int s0</h1>
<p>S0為主口．</p>
<h1 id="backup-int-asy-1">backup int asy 1</h1>
<p>A1口為備份口．</p>
<h1 id="backup-delay-0-1">backup delay 0 1</h1>
<p>延時1秒．<br>
(2)．配置虛擬接口</p>
<h1 id="conf-t-5">conf t</h1>
<h1 id="ip-addr-abcd-xxxx-5">ip addr ABCD XXXX</h1>
<p>ABCD為虛擬接口IP地址,XXXX為子網掩碼。</p>
<h1 id="encap-ppp">encap ppp</h1>
<p>封裝ppp協議．</p>
<h1 id="dialer-in-band">dialer in-band</h1>
<p>激活隨叫隨撥功能．</p>
<h1 id="dialer-idle-timeout-7200">dialer idle-timeout 7200</h1>
<h1 id="dialer-map-ip-abcd-modem-script-call-broadcast-6225481-br-映射對應的撥號口">dialer map ip ABCD modem-script call broadcast 6225481 br 映射對應的撥號口．</h1>
<p>ABCD為對方撥號口的ip地址，6225481為對應的電話號碼。</p>
<h1 id="dialer_group-1-定義撥號組成員">dialer_group 1 定義撥號組成員．</h1>
<p>(3)．配置防火牆</p>
<h1 id="dialer_list-1-pro-ip-permit">dialer_list 1 pro ip permit</h1>
<p>允許ip協議通過。<br>
(4)．配置連接口令</p>
<h1 id="user-name-abcd-pass-xxxx">user name ABCD pass XXXX</h1>
<p>ABCD為對方主機名,XXXX為連接口令．<br>
(5)．配置撥號字符串</p>
<h1 id="conf-t-6">conf t</h1>
<h1 id="chat-script-call-abort-busy-abort-error-atdt-6335481-timeout-45-connect">chat-script call ABORT BUSY ABORT ERROR&quot;&quot; atdt 6335481 TIMEOUT 45 &ldquo;CONNECT&rdquo;</h1>
<p>6335481為對方電話號碼。<br>
（6）．配置撥號連接密碼</p>
<h1 id="conf-t-7">conf t</h1>
<h1 id="username-rou1-pass-xxxx">username ROU1 pass XXXX</h1>
<p>ROU1為對方路由器名，XXXX為連接密碼。<br>
(7)．配置線路</p>
<h1 id="conf-ｔ-1">conf ｔ</h1>
<h1 id="line-aux-0">line aux 0</h1>
<h1 id="modem-inout">modem inout</h1>
<p>MODEM雙向傳輸。</p>
<h1 id="modem-autoconfigure-discovery">modem autoconfigure discovery</h1>
<h1 id="transport-input-all">transport input all</h1>
<h1 id="rxspeed-51200">rxspeed 51200</h1>
<p>MODEM的收發速率為51200 。</p>
<h1 id="exit-4">exit</h1>
<p>7．配置同步/異步口 （適用於2522）</p>
<h1 id="conf-t-8">conf t</h1>
<h1 id="int-s2-1">int s2</h1>
<h1 id="ph-asyn">ph asyn</h1>
<p>配置S2為異步口．</p>
<h1 id="ph-sync">ph sync、</h1>
<p>配置S2為同步口．<br>
8．動態路由的配置</p>
<h1 id="conf-t-9">conf t</h1>
<h1 id="router-eigrp-20">router eigrp 20</h1>
<p>使用EIGRP路由協議。常用的路由協議有RIP，IGRP，IS-IS等。</p>
<h1 id="passive-interface-serial0">passive-interface serial0</h1>
<p>若S0與X.25相連，則輸入本條指令。</p>
<h1 id="passive-interface-serial1">passive-interface serial1</h1>
<p>若S1與X.25相連，則輸入本條指令。</p>
<h1 id="network-abcd">network ABCD</h1>
<p>ABCD為本機的以太網地址。</p>
<h1 id="network-xxxx">network XXXX</h1>
<p>XXXX為S0的ip地址。</p>
<h1 id="no-auto-summary">no auto-summary</h1>
<h1 id="exit-5">exit</h1>
<p>9．靜態路由的配置</p>
<h1 id="ip-router-abcd-xxxx-yyyy-90">ip router ABCD XXXX YYYY 90</h1>
<p>ABCD為對方路由器的以太網地址；XXXX為子網掩碼.；YYYY為對方對應的廣域網端口地址。</p>
<h1 id="dialer-list-1-protocol-ip-permail">dialer-list 1 protocol ip permail</h1>
<p>10．備份配置文件到硬盤</p>
<h1 id="copy-run-tftp">copy run tftp</h1>
<p>在硬盤上建立一個空文件且有讀寫權限,才能備份成功．<br>
11．恢復備份配置文件到路由器</p>
<h1 id="copy-tftp-run">copy tftp run</h1>
<p>12．在路由器上建一個備份</p>
<h1 id="copy-run-start">copy run start</h1>
<p>路由器的配置參數較多，可根據實際需要增減，<br>
限於篇幅，本文僅給出了一般的常用配置。<br>
-&mdash; ． 調 試<br>
-&mdash; 1. 首 先 將 路 由 器 的Ethernet 口 和 所 有 要 使 用 的 串 口 都 激 活， 方 法 是 進 入 該 口， 執 行No Shutdown。<br>
-&mdash; 2. 將 和 路 由 器 相 連 的 主 機 加 上 缺 省 路 由（ 中 心 路 由 器 的Ethernet 地 址）， 方 法 是 在UNIX 系 統 的 超 級 用 戶 下 執 行：router add defaule XXXX 1（XXXX 為 路 由 器 的E0 口 地 址）。 每 台 主 機 都 要 加 缺 省 路 由， 否 則， 將 不 能 正 常 通 訊。<br>
-&mdash; 3. Ping 本 機 的 路 由 器Ethernet 網 口（ 若 不 通：（1）Ethetnet 網 口 沒 有 激 活（2） 不 在 一 個 網 上）、 廣 域 網 口（ 若 不 通： 沒 有 加 缺 省 路 由）， 對 方 廣 域 網 口（ 若 不 通： 路 由 器 配 置 錯 誤）、 路 由 器Ethernet 網 口（ 若 不 通： 路 由 器 配 置 錯 誤）、 主 機Ethernet 網 口（ 若 不 通： 對 方 主 機 沒 有 加 缺 省 路 由）。<br>
-&mdash; 4. 在 專 線 卡(X.25) 主 機 上 加 網 關（ 靜 態 路 由）， 方 法 是 在UNIX 系 統 的 超 級 用 戶 下 執 行：router add X.X.X.X Y.Y.Y.Y 1。 X.X.X.X 為 對 方Ethernet 網 地 址；Y.Y.Y.Y 為 對 方 廣 域 網 地 址。<br>
-&mdash; 5. 使 用Tracert 對 路 由 進 行 跟 蹤， 以 確 定 不 通 網 段。<br>
WAN的配置<br>
1、 配置DDR<br>
Dial-on-demand routing(DDR)是用公共電話網提供了網絡連接.通常的,廣域網大多數用專線連接的,路由器連接到類似modem或ISDN TAs的數據終端DCE設備上,它們支持同步V.25bis協議,你可以用scripts和dialer命令設定撥號串.DDR比較適用於用戶對數率要求不高,偶爾有數據傳輸或只是在特定時候傳輸數據,比如銀行每晚傳送報表等等情況下.當一個感興趣的包到達路由器時,產生一個DDR請求.路由器發送呼叫建立信息給指定的串口的DCE設備.這個呼叫就把本地和遠程的設備連接起來.一旦沒有數據傳輸,空閒時間開始計時,超過設置的空閒時間,這一次連接終止.DDR現在都用靜態路由來傳輸數據包,避免路由交換引起的DDR撥號.AppleTalk,Banyan VINES, CLNS, DECnet, IP, IPX, 和XNS可以通過DDR路由尋址.同步串口,異步串口和ISDN端口可以配置成到一個或多個目的地DDR連接.在配置DDR過程中,我們可以把一個或幾個物理接口配置成一個邏輯撥號接口,它可以是同步V.25方式,同步DTR啟動撥號或異步chat script方式.在端口配置模式下:</p>
<p>功能命令<br>
在一個端口上激活 Dial-on-demand routing dialer in-band<br>
指定一個端口為撥號訪問組 dialer-group group-number<br>
指定一個單一電話號碼 dialer string dial-string<br>
斷線前空閒等待時間 dialer idle-time seconds<br>
定義一個或多個目的電話號碼表 dialer map protocol net-hop-address dialer-string<br>
限定傳輸的access-list表或特定協議 dialer-list dialer-group list access-list-number<br>
或 dialer-list dialer-group protocol protocol-name {permit|deny|list acce ss-list-number}<br>
其中dialer string和dialer map兩條命令任選一,dialer string是在只有一個電話號碼時用,而dialer map是一個電話號碼表.<br>
詳細配置說明請參閱下面&quot;DDR Example&quot;的實例.<br>
配置撥號備份<br>
撥號備份提供了一種保護,使得當廣域網上主幹線出現故障時,啟動一條備份線路,使通信正常運轉.<br>
啟動備份有兩種情況:<br>
主幹線斷掉<br>
傳輸流量超過了定義的最大值<br>
需作的定義如下:<br>
在主幹線路端口上設置它的備份端口 backup interface interface-name<br>
定義備份負載 backup load {enable-threshold | never} {disable-load |never}<br>
定義主幹線up或down的響應時間 backup delay {enable-delay | never) {disable-delay | never}<br>
其中: enable-threshold &mdash; 表示主幹線超過總傳輸量的百分比,啟動備份線路<br>
disable-load &mdash; 表示傳輸量減少百分之多少就斷開備份線路.<br>
enable-delay &mdash; 表示主幹線斷開多長時間後,啟動備份線路.<br>
disable-delay &mdash; 表示主幹線又重新恢復多長時間後,斷開備份線路.<br>
2、 配置幀中繼<br>
幀中繼是一種由ANSI和CCITT標準化的協議,它能為現今突發性業務流量(如LAN互連及SNA業務)提供顯著的性能價格優勢.幀中繼是客戶端設備(CPE),諸如路由器或前端處理器,和一個向遠程CPE發送數據的廣域網之間的一種接口協議.它有以下幾個特點:低時延，時延是指一個給定待發送幀穿過網絡到達遠程用戶設備所用的時間.當網絡時延增大時,性能會下降;尤其對於敏感協議(如SNA和DECnet),所有幀被發送後必須等待應答的協議(即Novell IPX),以及利用短交易式的應用.可靠性，在給定時延條件下,吞吐量隨著網絡的可靠性變化而變化,可靠性好,超時等待重發幀越少,吞吐量就會大大增加.更低的聯網開銷可預測性在許多網絡環境中,如SNA CICS,不僅要求時延低,而且需要可預測性.公平性。Ciscos Frame Relay目前支持IP,DECnet,AppleTalk, Xerox Network Service(XNS), Novell IPX, International Organization for Standards (ISO) Connectionless Network Service (CLNS), Banyan VINES, 和 transparent bridging在幀中繼中傳輸.<br>
配置幀中繼的工作表:<br>
在一個端口上作幀中繼打包<br>
定義動態或靜態的地址映射<br>
定義LMI<br>
配置幀中繼交換虛電路<br>
幀中繼交換<br>
監控幀中繼連接<br>
在一個端口上作幀中繼打包<br>
某一端口上配置幀中繼打包走幀中繼協議,在global配置模式下:<br>
功 能 命 令<br>
指定走幀中繼的端口並進入端口配置模式 interface serial number<br>
指定幀中繼打包方式 encapsulation frame-relay [ietf]<br>
Cisco的幀中繼與RFC 1490的打包方式一致,允許不同廠家的產品互相通信.當與其它廠家路由器連接時,請用IETF打包.<br>
定義動態或靜態的地址映射<br>
動態地址映射<br>
動態地址映射用幀中繼的翻轉ARP協議發送請求下一個希望到達的地址(next hopprotocol address)(假設知道DLCI),當有應答翻轉ARP協議請求時,保存在address-to-DLCI映射表中,這張表就用來提供下一個希望到達的地址或出去的DLCI地址翻轉ARP協議默認是打開的,故動態地址映射不需要做任何配置.<br>
靜態地址映射<br>
一個靜態地址映射是人為的指定下一個希望到達的地址(next hop protocol address)與DLCI的對應關係.當指定了靜態地址映射時,翻轉ARP協議自動關閉.<br>
建立靜態地址映射表需完成:<br>
功 能 命 令<br>
定義一個端口或子端口的DLCI地址 frame-relay interface-dlci dlci<br>
指定一個next hop protocol address與DLCI之間對應 frame-relay map protocol protocol-address dlci [broadcast] [ietf] [cisco]相應地,關鍵字protocol支持的協議:<br>
IP&mdash;ip<br>
DECnet&mdash;decnet</p>
<p>AppleTalk&mdash;appletalk<br>
XNS&mdash;xns<br>
Novell IPX&mdash;ipx<br>
VINES&mdash;vines<br>
ISO CLNS&mdash;clns<br>
如果是一點對一點,可用interface-dlci命令,若是一點對多點則設定 frame-relay map 一系列的dlci與ip address 對應表.<br>
定義LMII<br>
在Cisco IOS Release 11.2版本以上,支持本地管理接口LMI(Local managementInterface)自動識別,即由交換機端口決定LMI的類型.當然,我們也可以明確配置<br>
LMI類型.<br>
功 能 命 令<br>
建立路由器間keepalive時間 frame-relay keepalive number<br>
定義N391的間隔時間 frame-relay lmi-n391-dte keep-exchanges<br>
配置幀中繼交換虛電路<br>
目前,訪問幀中繼網是56K到45M數率,幀中繼是在兩個節點間建立面向連接的,包交換的虛電路.<br>
在一個物理端口上配置SVCs<br>
在子端口上配置SVCs<br>
在一個幀中繼端口上配置SVC操作</p>
<p>功 能 命 令<br>
指定物理端口 interface serial number<br>
如果需要,配置IP地址 ip address ip-address mask<br>
在這個端口上配置幀中繼打包 encapsulation frame-relay<br>
在這個端口上激活幀中繼SVC frame-relay svc</p>
<p>在子端口上配置SVCs</p>
<p>功 能 命 令<br>
在主端口上指定一個子端口 interface serial number.subinterface-number {multipoint | point-to-point}<br>
如果需要,配置IP地址 ip address ip-address mask<br>
參閱下面&quot;Configure subinterface Example&quot;的例子.</p>
<p>幀中繼交換</p>
<p>當一個幀中繼網要通過IP網與另一個幀中繼網互連,就要用到幀中繼交換.把IP網<br>
看作幀中繼包的隧道通過去.<br>
實現幀中繼交換,配置如下:<br>
功 能 命 令<br>
把路由器作為幀中繼交換機 frame-relay switching<br>
在路由器上設置靜態路由 frame-relay route in-dlci out-interface out-dlci<br>
定義網絡功能 frame-relay intf-type {dte| dce| nni}<br>
請參閱&quot;Frame Relay Switching Example&quot;配置實例.<br>
監控幀中繼連接<br>
在EXEC模式下:<br>
功 能 命 令<br>
顯示幀中繼DLCI和LMI信息 show interface serial number<br>
顯示LMI狀態 show frame-relay lmi [type number]<br>
顯示PVC狀態 show frame-relay pvc [type number [dlci]]<br>
顯示配置靜態路由 show frame-relay route<br>
顯示幀中繼傳輸狀態 show frame-relay traffic<br>
3、配置DDN<br>
DDN(Digital Data Network)是一種點對點的同步數據通信鏈路.它支持PPP,SLIP,HDLC和SDLC等鏈路層通信協議.允許IP, Novell IPX, Bridging,CLNS,AppleTalk,DECnet等多種上層協議在上面運行.</p>
<p>基本配置<br>
壓縮技術<br>
E1端口配置<br>
基本配置</p>
<p>功 能 命 令<br>
進入指定端口 interface serial number<br>
定義該端口IP地址 ip address ip-address mask<br>
指定該端口打包方式 encapsulation {PPP| HDLC }</p>
<p>壓縮技術</p>
<p>通常在串口中傳輸的數據是不壓縮的,它允許數據包頭在每次傳輸時正常交換,但每次將浪費帶寬.目前支持的壓縮有PPP,Frame Relay, X.25, TCP等等.</p>
<p>Cisco的壓縮是通過軟件完成的,將影響系統性能.故建議路由器CPU佔用超過65%,就不要使用壓縮.(show process cpu EXEC命令查看當前CPU使用情況)</p>
<p>功 能 命 令<br>
TCP傳輸頭壓縮 ip tcp head-compression [passive]<br>
X.25壓縮 X25 compress<br>
PPP壓縮 ppp compress [predictir|stac]</p>
<p>注: &ldquo;passive&quot;表示只有輸入包是壓縮時,輸出包才壓縮.</p>
<p>E1端口配置</p>
<p>在Cisco 4500,4700,7000和7500系列裏面均支持E1(2.048Mbps)數率的接口.每一個E1端口可以按時隙分成30路64K數據線路和2路信號線路.這30個64K數據線路每一路均可以當作一條64K的專線.</p>
<p>功 能 命 令<br>
在配置模式下,定義Controller E1 controller e1 slot/port<br>
定義line code linecode {ami |hdb3}<br>
定義字符幀 framing {crc4 |no-crc4}<br>
定義E1組 channel-group number timeslots range [speed {48| 56| 64}]<br>
指定串口屬於那一個channel-group組 interface serial slot/port:channel-group<br>
注:slot/port&mdash;-是針對7000或7500系列的,故區分槽口號和端口號.<br>
linecode&mdash;-默認是HDB3.<br>
framing&mdash;-默認是crc4,要與電信局參數匹配.<br>
channel-group&mdash;-每個E1可以分成30個channel-group,把channel-group和時間槽對應起來.channel-group是0-30,timeslots是1-31.<br>
interface serial&mdash;-在定義完E1 channel-group後,我們把group賦予成一個虛擬串口.<br>
具體的請參閱&quot;Channelized E1 Interface Example&quot;實例.<br>
4、配置X.25</p>
<p>X.25配置完成如下工作:<br>
功 能 命 令<br>
設置X.25模式 encapsulation x25 [dte|dce]<br>
設置最大虛電路數 x25 htc max-vc-number<br>
設置X.121地址 x25 address x121-address<br>
建立IP地址與X.121地址對應 x25 map ip ip-address x121-addres [broadcast]<br>
htc&mdash;-htc是最大的虛電路數,因為許多X.25交換機是從高到低建立虛電路的,max-vc-number不能超過申請的最大值.<br>
請參閱&quot;X.25 Example&quot;的配置實例.<br>
5、配置HDLC:<br>
HDLC是CISCO路由器使用的缺省協議，一台新路由器在未指定封裝協議時默認使用HDLC封裝。<br>
A.有關命令<br>
端口設置:<br>
任務 命令<br>
設置HDLC封裝 encapsulation hdlc<br>
設置DCE端線路速度 clockrate speed<br>
復位一個硬件接口 clear interface serial unit<br>
顯示接口狀態 show interfaces serial [unit] 1<br>
注:1.以下給出一個顯示Cisco同步串口狀態的例子.</p>
<p>Router#show interface serial 0<br>
Serial 0 is up, line protocol is up<br>
Hardware is MCI Serial<br>
Internet address is 150.136.190.203, subnet mask is 255.255.255.0<br>
MTU 1500 bytes, BW 1544 Kbit, DLY 20000 usec, rely 255/255, load 1/255<br>
Encapsulation HDLC, loopback not set, keepalive set (10 sec)<br>
Last input 0:00:07, output 0:00:00, output hang never<br>
Output queue 0/40, 0 drops; input queue 0/75, 0 drops<br>
Five minute input rate 0 bits/sec, 0 packets/sec<br>
Five minute output rate 0 bits/sec, 0 packets/sec<br>
16263 packets input, 1347238 bytes, 0 no buffer<br>
Received 13983 broadcasts, 0 runts, 0 giants<br>
2 input errors, 0 CRC, 0 frame, 0 overrun, 0 ignored, 2 abort<br>
22146 packets output, 2383680 bytes, 0 underruns<br>
0 output errors, 0 collisions, 2 interface resets, 0 restarts<br>
1 carrier transitions<br>
B. 舉例:<br>
設置如下：<br>
Router1:</p>
<p>interface Serial0<br>
ip address 192.200.10.1 255.255.255.0<br>
clockrate 1000000<br>
Router2:</p>
<p>interface Serial0<br>
ip address 192.200.10.2 255.255.255.0<br>
!<br>
C. 舉例使用E1線路實現多個64K專線連接.<br>
相關命令:<br>
任務 命令<br>
進入controller配置模式 controller {t1 | e1} number<br>
選擇幀類型 framing {crc4 | no-crc4}<br>
選擇line-code類型 linecode {ami | b8zs | hdb3}<br>
建立邏輯通道組與時隙的映射 channel-group number timeslots range1<br>
顯示controllers接口狀態 show controllers e1 [slot/port]2<br>
注: 1. 當鏈路為T1時,channel-group編號為0-23, Timeslot範圍1-24; 當鏈路為E1時, channel-group編號為0-30, Timeslot範圍1-31.<br>
2.使用show controllers e1觀察controller狀態,以下為幀類型為crc4時controllers正常的狀態.<br>
Router# show controllers e1<br>
e1 0/0 is up.<br>
Applique type is Channelized E1 - unbalanced<br>
Framing is CRC4, Line Code is HDB3 No alarms detected.<br>
Data in current interval (725 seconds elapsed):<br>
0 Line Code Violations, 0 Path Code Violations<br>
0 Slip Secs, 0 Fr Loss Secs, 0 Line Err Secs, 0 Degraded Mins<br>
0 Errored Secs, 0 Bursty Err Secs, 0 Severely Err Secs, 0 Unavail Secs<br>
Total Data (last 24 hours) 0 Line Code Violations, 0 Path Code Violations,<br>
0 Slip Secs, 0 Fr Loss Secs, 0 Line Err Secs, 0 Degraded Mins,<br>
0 Errored Secs, 0 Bursty Err Secs, 0 Severely Err Secs, 0 Unavail Secs<br>
以下例子為E1連接3條64K專線, 幀類型為NO-CRC4,非平衡鏈路,路由器具體設置如下:</p>
<p>shanxi#wri t<br>
Building configuration&hellip;<br>
Current configuration:<br>
!<br>
version 11.2<br>
no service udp-small-servers<br>
no service tcp-small-servers<br>
!<br>
hostname shanxi<br>
!<br>
enable secret 5 $1$XN08$Ttr8nfLoP9.2RgZhcBzkk/<br>
enable password shanxi<br>
!<br>
!<br>
ip subnet-zero<br>
!<br>
controller E1 0<br>
framing NO-CRC4<br>
channel-group 0 timeslots 1<br>
channel-group 1 timeslots 2<br>
channel-group 2 timeslots 3<br>
!<br>
interface Ethernet0<br>
ip address 133.118.40.1 255.255.0.0<br>
media-type 10BaseT<br>
!<br>
interface Ethernet1<br>
no ip address<br>
shutdown<br>
!<br>
interface Serial0:0<br>
ip address 202.119.96.1 255.255.255.252<br>
no ip mroute-cache<br>
!<br>
interface Serial0:1<br>
ip address 202.119.96.5 255.255.255.252<br>
no ip mroute-cache<br>
!<br>
interface Serial0:2<br>
ip address 202.119.96.9 255.255.255.252<br>
no ip mroute-cache<br>
!<br>
no ip classless<br>
ip route 133.210.40.0 255.255.255.0 Serial0:0<br>
ip route 133.210.41.0 255.255.255.0 Serial0:1<br>
ip route 133.210.42.0 255.255.255.0 Serial0:2<br>
!<br>
line con 0<br>
line aux 0<br>
line vty 0 4<br>
password shanxi<br>
login<br>
!<br>
end<br>
6、配置PPP:<br>
PPP(Point-to-Point Protocol)是SLIP(Serial Line IP protocol)的繼承者，它提供了跨過同步和異步電路實現路由器到路由器(router-to-router)和主機到網絡(host-to-network)的連接。</p>
<p>CHAP(Challenge Handshake Authentication Protocol)和PAP(Password Authentication Protocol) (PAP)通常被用於在PPP封裝的串行線路上提供安全性認證。使用CHAP和PAP認證,每個路由器通過名字來識別，可以防止未經授權的訪問。</p>
<p>CHAP和PAP在RFC 1334上有詳細的說明。</p>
<p>A. 有關命令<br>
端口設置<br>
任務 命令<br>
設置PPP封裝 encapsulation ppp1<br>
設置認證方法 ppp authentication {chap | chap pap | pap chap | pap} [if-needed] [list-name | default] [callin]<br>
指定口令 username name password secret<br>
設置DCE端線路速度 clockrate speed<br>
注：1、要使用CHAP/PAP必須使用PPP封裝。在與非Cisco路由器連接時，一般採用PPP封裝，其它廠家路由器一般不支持Cisco的HDLC封裝協議。<br>
2. 舉例<br>
路由器Router1和Router2的S0口均封裝PPP協議，採用CHAP做認證，在Router1中應建立一個用戶，以對端路由器主機名作為用戶名，即用戶名應為router2。同時在Router2中應建立一個用戶，以對端路由器主機名作為用戶名，即用戶名應為router1。所建的這兩用戶的password必須相同。<br>
設置如下：<br>
Router1:</p>
<p>hostname router1<br>
username router2 password xxx<br>
interface Serial0<br>
ip address 192.200.10.1 255.255.255.0<br>
clockrate 1000000<br>
ppp authentication chap<br>
!<br>
Router2:</p>
<p>hostname router2<br>
username router1 password xxx<br>
interface Serial0<br>
ip address 192.200.10.2 255.255.255.0<br>
ppp authentication chap</p>
<p>7、廣域網配置實例</p>
<p>DDR Example<br>
Dial Backup Example<br>
Configure subinterface Example<br>
Frame Relay Switching Example<br>
Channelized E1 Interface Example<br>
X.25 Example<br>
DDR Example</p>
<p>例：</p>
<p>Configuration for RouterA:</p>
<p>ip route 131.108.29.0 131.108.126.2<br>
ip route 131.108.1.0 131.108.126.2<br>
dialer-list 1 protocol ip permit<br>
dialer-list 1 protocol ipx deny<br>
!<br>
interface serial 0<br>
ip address 131.108.126.1 255.255.255.0<br>
dialer in-band<br>
dialer-group 1<br>
!<br>
dialer map ip 131.108.126.2 5551234<br>
!<br>
dialer idle-timeout 300</p>
<p>Dial Backup Example</p>
<p>A)同步V.25 bits方式</p>
<p>Configuration for RouterA:</p>
<p>interface Serial0:0<br>
backup delay 0 10<br>
backup interface Serial10<br>
ip address 16.217.30.2 255.255.255.252<br>
!<br>
interface Serial10<br>
ip address 16.30.16.81 255.255.255.0<br>
encapsulation ppp<br>
dialer in-band<br>
dialer string 8292<br>
dialer-group 1<br>
pulse-time 1<br>
!<br>
dialer-list 1 protocol ip permit</p>
<p>B)輔助口作撥號備份</p>
<p>Configuration for RouterA:</p>
<p>chat-script MYDIAL &quot;&rdquo; &ldquo;atdt 8292&rdquo; TIMEOUT 60 &ldquo;CONNECT&rdquo;<br>
!<br>
interface Serial0<br>
backup delay 0 0<br>
backup interface Async1<br>
ip address 16.3.1.1 255.255.255.0</p>
<p>encapsulation ppp<br>
!<br>
interface Async1<br>
ip address 16.3.2.1 255.255.255.0<br>
encapsulation ppp<br>
keepalive 9<br>
async default routing<br>
async dynamic address<br>
async dynamic routing<br>
async mode dedicated<br>
dialer in-band<br>
dialer string 8292<br>
dialer-group 1<br>
!<br>
dialer-list 1 protocol ip permit<br>
!<br>
line aux 0<br>
script dialer MYDIAL<br>
modem InOut<br>
transport output none<br>
stopbits 1<br>
flowcontrol hardware<br>
speed 9600</p>
<p>Subinterface Example(Frame Relay)</p>
<p>Configuration for RouterA:</p>
<p>interface serial 0<br>
encapsulation frame-relay<br>
interface s 0.1 multipoint<br>
ip address 11.10.11.1 255.255.255.0<br>
frame-relay interface-dlci 41<br>
frame-relay interface-dlci 42</p>
<p>Configuration for RouterC:</p>
<p>interface serial 0<br>
encapsulation frame-relay<br>
interface s 0.1 point-to-point<br>
ip address 11.10.16.2 255.255.255.0<br>
frame-relay interface-dlci 46</p>
<p>Configuration for RouterB:</p>
<p>interface serial 0<br>
encapsulation frame-relay<br>
interface s 0.1 multipoint<br>
ip address 11.10.11.3 255.255.255.0<br>
frame-relay interface-dlci 43<br>
frame-relay interface-dlci 44<br>
!<br>
interface s 0.2 point-to-point<br>
ip address 11.10.13.1 255.255.255.0<br>
frame-relay interface-dlci 48</p>
<p>Frame Relay Switching Example</p>
<p>Configuration for RouterA:</p>
<p>frame-relay switching<br>
!<br>
int s 0<br>
no ip address<br>
frame-relay encapsulation<br>
frame-relay route 167 tun0 43<br>
frame-relay intf-type dce<br>
!<br>
int s 1<br>
ip address 131.108.100.1 255.255.255.0<br>
!<br>
int tu 0<br>
tunnel source serial 1<br>
tunnel destination 131.108.13.2</p>
<p>Configuration for RouterB:</p>
<p>frame-relay switching<br>
!<br>
int s 0<br>
no ip address<br>
frame-relay encapsulation<br>
frame-relay route 9 tun0 43<br>
frame-relay intf-type dce<br>
!<br>
int s 1<br>
ip address 131.108.13.2 255.255.255.0<br>
!<br>
int tu 0<br>
tunnel source serial 1<br>
tunnel destination 131.108.100.1</p>
<p>Channelized E1 Interface Example</p>
<p>假設是7500系列路由器,E1接口(MIP板)在插槽4上面.一個channel-group可對應多個時間槽,本例中serial4/0:1有5*64Kbps的數率.<br>
Configuration for Router:</p>
<p>controller E1 0<br>
framing NO-CRC4<br>
channel-group 0 timeslots 1<br>
channel-group 1 timeslots 2,7-9,20 speed 64<br>
!<br>
interface Serial4/0:0<br>
ip address 16.217.30.2 255.255.255.252<br>
encapsulation ppp<br>
!<br>
interface Serial4/0:1<br>
ip address 16.205.30.5 255.255.255.252</p>
<p>X.25 Example</p>
<p>在配置X.25時,為減少路由交換引起的呼叫,通常用靜態路由.而當一對多情況下,<br>
不在一個子網中用subinterface配置.</p>
<p>Configuration for Router:</p>
<p>interface serial 0<br>
ip address 131.108.100.1 255.255.255.0<br>
encapsulation x25<br>
x25 address 041673226839<br>
x25 htc 16<br>
x25 map ip 131.108.100.2 041675222222<br>
int s 0.1<br>
ip address 131.108.101.1 255.255.255.0<br>
x25 map ip 131.108.101.2 041674222222<br>
!<br>
ip route 131.108.100.0 255.255.255.0 131.108.100.2<br>
ip route 131.108.101.0 255.255.255.0 131.108.101.2</p>
<p>路由協議設置<br>
一、RIP協議<br>
RIP(Routing information Protocol)是應用較早、使用較普遍的內部網關協議(Interior Gateway Protocol,簡稱IGP)，適用於小型同類網絡，是典型的距離向量(distance-vector)協議。文檔見RFC1058、RFC1723。<br>
RIP通過廣播UDP報文來交換路由信息，每30秒發送一次路由信息更新。RIP提供跳躍計數(hop count)作為尺度來衡量路由距離，跳躍計數是一個包到達目標所必須經過的路由器的數目。如果到相同目標有二個不等速或不同帶寬的路由器，但跳躍計數相同，則RIP認為兩個路由是等距離的。RIP最多支持的跳數為15，即在源和目的網間所要經過的最多路由器的數目為15，跳數16表示不可達。<br>
1. 有關命令<br>
任務 命令<br>
指定使用RIP協議 router rip<br>
指定RIP版本 version {1|2}1<br>
指定與該路由器相連的網絡 network network<br>
注：1.Cisco的RIP版本2支持驗證、密鑰管理、路由匯總、無類域間路由(CIDR)和變長子網掩碼(VLSMs)<br>
2. 舉例<br>
Router1:</p>
<p>router rip<br>
version 2<br>
network 192.200.10.0<br>
network 192.20.10.0<br>
！<br>
相關調試命令：<br>
show ip protocol<br>
show ip route</p>
<p>二、IGRP協議<br>
IGRP (Interior Gateway Routing Protocol)是一種動態距離向量路由協議，它由Cisco公司八十年代中期設計。使用組合用戶配置尺度，包括延遲、帶寬、可靠性和負載。<br>
缺省情況下，IGRP每90秒發送一次路由更新廣播，在3個更新週期內(即270秒)，沒有從路由中的第一個路由器接收到更新，則宣佈路由不可訪問。在7個更新週期即630秒後，Cisco IOS 軟件從路由表中清除路由。<br>
1. 有關命令<br>
任務 命令<br>
指定使用RIP協議 router igrp autonomous-system1<br>
指定與該路由器相連的網絡 network network<br>
指定與該路由器相鄰的節點地址 neighbor ip-address<br>
注：1、autonomous-system可以隨意建立，並非實際意義上的autonomous-system,但運行IGRP的路由器要想交換路由更新信息其autonomous-system需相同。<br>
2．舉例</p>
<p>Router1:<br>
router igrp 200<br>
network 192.200.10.0<br>
network 192.20.10.0<br>
!</p>
<p>三、OSPF協議<br>
OSPF(Open Shortest Path First)是一個內部網關協議(Interior Gateway Protocol,簡稱IGP)，用於在單一自治系統(autonomous system,AS)內決策路由。與RIP相對，OSPF是鏈路狀態路由協議，而RIP是距離向量路由協議。<br>
鏈路是路由器接口的另一種說法，因此OSPF也稱為接口狀態路由協議。OSPF通過路由器之間通告網絡接口的狀態來建立鏈路狀態數據庫，生成最短路徑樹，每個OSPF路由器使用這些最短路徑構造路由表。<br>
1．有關命令<br>
全局設置<br>
任務 命令<br>
指定使用OSPF協議 router ospf process-id1<br>
指定與該路由器相連的網絡 network address wildcard-mask area area-id2<br>
指定與該路由器相鄰的節點地址 neighbor ip-address<br>
注：1、OSPF路由進程process-id必須指定範圍在1-65535，多個OSPF進程可以在同一個路由器上配置，但最好不這樣做。多個OSPF進程需要多個OSPF數據庫的副本，必須運行多個最短路徑算法的副本。process-id只在路由器內部起作用，不同路由器的process-id可以不同。<br>
2、wildcard-mask 是子網掩碼的反碼, 網絡區域ID area-id在0-4294967295內的十進制數，也可以是帶有IP地址格式的x.x.x.x。當網絡區域ID為0或0.0.0.0時為主幹域。不同網絡區域的路由器通過主幹域學習路由信息。<br>
2．基本配置舉例:<br>
Router1:<br>
interface ethernet 0<br>
ip address 192.1.0.129 255.255.255.192<br>
!<br>
interface serial 0<br>
ip address 192.200.10.5 255.255.255.252<br>
!<br>
router ospf 100<br>
network 192.200.10.4 0.0.0.3 area 0<br>
network 192.1.0.128 0.0.0.63 area 1<br>
!<br>
Router2:</p>
<p>interface ethernet 0<br>
ip address 192.1.0.65 255.255.255.192<br>
!<br>
interface serial 0<br>
ip address 192.200.10.6 255.255.255.252<br>
!<br>
router ospf 200<br>
network 192.200.10.4 0.0.0.3 area 0<br>
network 192.1.0.64 0.0.0.63 area 2<br>
!<br>
Router3:</p>
<p>interface ethernet 0<br>
ip address 192.1.0.130 255.255.255.192<br>
!<br>
router ospf 300<br>
network 192.1.0.128 0.0.0.63 area 1<br>
!<br>
Router4:</p>
<p>interface ethernet 0<br>
ip address 192.1.0.66 255.255.255.192<br>
!<br>
router ospf 400<br>
network 192.1.0.64 0.0.0.63 area 1<br>
!<br>
相關調試命令：<br>
debug ip ospf events<br>
debug ip ospf packet<br>
show ip ospf<br>
show ip ospf database<br>
show ip ospf interface<br>
show ip ospf neighbor<br>
show ip route<br>
3. 使用身份驗證<br>
為了安全的原因，我們可以在相同OSPF區域的路由器上啟用身份驗證的功能，只有經過身份驗證的同一區域的路由器才能互相通告路由信息。<br>
在默認情況下OSPF不使用區域驗證。通過兩種方法可啟用身份驗證功能，純文本身份驗證和消息摘要(md5)身份驗證。純文本身份驗證傳送的身份驗證口令為純文本，它會被網絡探測器確定，所以不安全，不建議使用。而消息摘要(md5)身份驗證在傳輸身份驗證口令前，要對口令進行加密，所以一般建議使用此種方法進行身份驗證。<br>
使用身份驗證時，區域內所有的路由器接口必須使用相同的身份驗證方法。為起用身份驗證，必須在路由器接口配置模式下，為區域的每個路由器接口配置口令。<br>
任務 命令<br>
指定身份驗證 area area-id authentication [message-digest]<br>
使用純文本身份驗證 ip ospf authentication-key password<br>
使用消息摘要(md5)身份驗證 ip ospf message-digest-key keyid md5 key<br>
以下列舉兩種驗證設置的示例，示例的網絡分佈及地址分配環境與以上基本配置舉例相同，只是在Router1和Router2的區域0上使用了身份驗證的功能。:<br>
1.使用純文本身份驗證<br>
Router1:</p>
<p>interface ethernet 0<br>
ip address 192.1.0.129 255.255.255.192<br>
!<br>
interface serial 0<br>
ip address 192.200.10.5 255.255.255.252<br>
ip ospf authentication-key cisco<br>
!<br>
router ospf 100<br>
network 192.200.10.4 0.0.0.3 area 0<br>
network 192.1.0.128 0.0.0.63 area 1<br>
area 0 authentication<br>
!<br>
Router2:</p>
<p>interface ethernet 0<br>
ip address 192.1.0.65 255.255.255.192<br>
!<br>
interface serial 0<br>
ip address 192.200.10.6 255.255.255.252<br>
ip ospf authentication-key cisco<br>
!<br>
router ospf 200<br>
network 192.200.10.4 0.0.0.3 area 0<br>
network 192.1.0.64 0.0.0.63 area 2<br>
area 0 authentication<br>
!<br>
例2.消息摘要(md5)身份驗證：<br>
Router1:</p>
<p>interface ethernet 0<br>
ip address 192.1.0.129 255.255.255.192<br>
!<br>
interface serial 0<br>
ip address 192.200.10.5 255.255.255.252<br>
ip ospf message-digest-key 1 md5 cisco<br>
!<br>
router ospf 100<br>
network 192.200.10.4 0.0.0.3 area 0<br>
network 192.1.0.128 0.0.0.63 area 1<br>
area 0 authentication message-digest<br>
!<br>
Router2:</p>
<p>interface ethernet 0<br>
ip address 192.1.0.65 255.255.255.192<br>
!<br>
interface serial 0<br>
ip address 192.200.10.6 255.255.255.252<br>
ip ospf message-digest-key 1 md5 cisco<br>
!<br>
router ospf 200<br>
network 192.200.10.4 0.0.0.3 area 0<br>
network 192.1.0.64 0.0.0.63 area 2<br>
area 0 authentication message-digest<br>
!<br>
相關調試命令：<br>
debug ip ospf adj<br>
debug ip ospf events</p>
<p>四、重新分配路由<br>
在實際工作中，我們會遇到使用多個IP路由協議的網絡。為了使整個網絡正常地工作，必須在多個路由協議之間進行成功的路由再分配。<br>
以下列舉了OSPF與RIP之間重新分配路由的設置範例：<br>
Router1的Serial 0端口和Router2的Serial 0端口運行OSPF，在Router1的Ethernet 0端口運行RIP 2，Router3運行RIP2，Router2有指向Router4的192.168.2.0/24網的靜態路由，Router4使用默認靜態路由。需要在Router1和Router3之間重新分配OSPF和RIP路由，在Router2上重新分配靜態路由和直連的路由。<br>
範例所涉及的命令<br>
任務 命令<br>
重新分配直連的路由 redistribute connected<br>
重新分配靜態路由 redistribute static<br>
重新分配ospf路由 redistribute ospf process-id metric metric-value<br>
重新分配rip路由 redistribute rip metric metric-value<br>
Router1:</p>
<p>interface ethernet 0<br>
ip address 192.168.1.1 255.255.255.0<br>
!<br>
interface serial 0<br>
ip address 192.200.10.5 255.255.255.252<br>
!<br>
router ospf 100<br>
redistribute rip metric 10<br>
network 192.200.10.4 0.0.0.3 area 0<br>
!<br>
router rip<br>
version 2<br>
redistribute ospf 100 metric 1<br>
network 192.168.1.0<br>
!<br>
Router2:</p>
<p>interface loopback 1<br>
ip address 192.168.3.2 255.255.255.0<br>
!<br>
interface ethernet 0<br>
ip address 192.168.0.2 255.255.255.0<br>
!<br>
interface serial 0<br>
ip address 192.200.10.6 255.255.255.252<br>
!<br>
router ospf 200<br>
redistribute connected subnet<br>
redistribute static subnet<br>
network 192.200.10.4 0.0.0.3 area 0<br>
!<br>
ip route 192.168.2.0 255.255.255.0 192.168.0.1<br>
！<br>
Router3:</p>
<p>interface ethernet 0<br>
ip address 192.168.1.2 255.255.255.0<br>
!<br>
router rip<br>
version 2<br>
network 192.168.1.0<br>
!<br>
Router4:</p>
<p>interface ethernet 0<br>
ip address 192.168.0.1 255.255.255.0<br>
!<br>
interface ethernet 1<br>
ip address 192.168.2.1 255.255.255.0<br>
!<br>
ip route 0.0.0.0 0.0.0.0 192.168.0.2<br>
!</p>
<p>五、IPX協議設置<br>
IPX協議與IP協議是兩種不同的網絡層協議，它們的路由協議也不一樣，IPX的路由協議不象IP的路由協議那樣豐富，所以設置起來比較簡單。但IPX協議在以太網上運行時必須指定封裝形式。<br>
1． 有關命令<br>
啟動IPX路由 ipx routing<br>
設置IPX網絡及以太網封裝形式 ipx network network [encapsulation encapsulation-type]1<br>
指定路由協議，默認為RIP ipx router {eigrp autonomous-system-number | nlsp [tag] | rip}<br>
注：1.network 範圍是1 到FFFFFFFD.<br>
IPX封裝類型列表<br>
接口類型 封裝類型 IPX幀類型<br>
Ethernet novell-ether (默認) arpa sap snap Ethernet_802.3 Ethernet_II Ethernet_802.2 Ethernet_Snap<br>
Token Ring sap (默認) snap Token-Ring Token-Ring_Snap<br>
FDDI snap (默認) sap novell-fddi Fddi_Snap Fddi_802.2 Fddi_Raw<br>
在此例中，WAN的IPX網絡為3a00,Router1所連接的局域網IPX網絡號為2a00,在此局域網有一台Novell服務器，IPX網絡號也是2a00, 路由器接口的IPX網絡號必須與在同一網絡的Novell服務器上設置的IPX網絡號相同。路由器通過監聽SAP來建立已知的服務及自己的網絡地址表，並每60秒發送一次自己的SAP表。<br>
Router1:</p>
<p>ipx routing<br>
interface ethernet 0<br>
ipx network 2a00 encapsulation sap<br>
!<br>
interface serial 0<br>
ipx network 3a00<br>
!<br>
ipx router eigrp 10<br>
network 3a00<br>
network 2a00<br>
!<br>
Router2:</p>
<p>ipx routing<br>
interface ethernet 0<br>
ipx network 2b00 encapsulation sap<br>
!<br>
interface serial 0<br>
ipx network 3a00<br>
!<br>
ipx router eigrp 10<br>
network 2b00<br>
network 3a00<br>
!<br>
相關調試命令：<br>
debug ipx packet<br>
debug ipx routing<br>
debug ipx sap<br>
debug ipx spoof<br>
debug ipx spx<br>
show ipx eigrp interfaces<br>
show ipx eigrp neighbors<br>
show ipx eigrp topology<br>
show ipx interface<br>
show ipx route<br>
show ipx servers<br>
show ipx spx-spoof<br>
關鍵字:子網掩碼 靜態路由 動態路由 ssl ospf</p>
<ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white white-70 dn dib-ns pv2 ph3 no-underline" href="/" >
    &copy;  Seth Dang博客 2025 
  </a>
    <div><div class="ananke-socials"></div>
</div>
  </div>
</footer>

  </body>
</html>
