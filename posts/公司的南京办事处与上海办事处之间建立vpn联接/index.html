<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>公司的南京办事处与上海办事处之间建立VPN联接 | Seth Dang'S</title><meta name=keywords content><meta name=description content="在公司的南京办事处与上海办事处之间建立VPN联接。
南京办事处网络设置：
内网IP 10.1.1.0/24
外网IP 202.102.1.5/24
上海办事处网络设置：
内网IP 10.1.2.0/24
外网IP 202.102.1.6/24
南京路由器配置
!
service timestamps debug uptime
service timestamps log uptime
no service password-encryption
!
hostname nanjing
!
enable cisco
!
!
crypto isakmp policy 1 生成iskamp policy number 1
encryption des 选择用DES encryption也可用3DES指定三倍DES加密
hash sha 指定使用的散列算法，也可以是md5(二端保持一致)
authentication pre-share
group 1 指定为Diffie-Hellman组,1表示768位,2表示1024位
lifetime 14400 指定安全关联的有效期，不设就为默认值
-&mdash;&ndash;以下配置密钥方法&mdash;&ndash;
crypto isakmp identity address 指定与远程路由器通信时使用isakmp标识
crypto isakmp key 654321 address 202.102.1.6 对远程路由器端口202.102.1.6使用密钥654321
crypto isakmp key 654321 address 192.168.1.2 对远程路由器隧道端口192.168.1.2使用密钥654321
!
-&mdash;&ndash;以下定义一个转换集&mdash;&ndash;
crypto ipsec transform-set tset1 ah-md5-hmac esp-des esp-md5-hmac 可以定义一个或多个集
!
!
-&mdash;&mdash;以下建立加密图&mdash;&mdash;
crypto map cmap1 local-address serial 0 定义加密图cmap1并指定s0为本地地址
crypto map cmap1 1 ipsec-isakmp 用序号1设置加密图
set peer 202.102.1.6 设定目标地址
set peer 192.168.1.2
set transform-set test1 指定转换集
match address 111 指定加密访问列表111中的地址
!
!
process-max-time 200
!
-&mdash;&mdash;以下设置隧道端口&mdash;&mdash;
interface Tunnel0
ip address 192.168.1.1 255.255.255.0
tunnel source 202.102.1.5
tunnel destination 202.102.1.6
crypto map cmap
!
-&mdash;&mdash;以下设置内网口&mdash;&mdash;
interface Ethernet0
ip address 10.1.1.1 255.255.255.0
!
-&mdash;&mdash;以下设置外网口&mdash;&mdash;
interface serial0
ip address 202.102.1.5 255.255.255.0
no ip mroute-cache
no fair-queue
crypto map cmap
!
ip classless
!
-&mdash;&mdash;以下建立访问列表111&mdash;&mdash;
access-list 111 permit ip host 202.102.1.5 host 202.102.1.6
access-list 111 permit ip host 202.102.1.6 host 202.102.1.5
access-list 111 permit ip 10.1.1.0 0.0.0.255 202.102.1.0 0.0.0.255
access-list 111 permit ip 10.1.2.0 0.0.0.255 202.102.1.0 0.0.0.255
access-list 111 permit ip 10.1.1.0 0.0.0.255 10.1.2.0 0.0.0.255
access-list 111 permit ip 10.1.2.0 0.0.0.255 10.1.1.0 0.0.0.255
!
line con 0
line aux 0
line vty 0 4
password cisco
login
!
end
!"><meta name=author content="Seth"><link rel=canonical href=https://seth.dpdns.org/posts/%E5%85%AC%E5%8F%B8%E7%9A%84%E5%8D%97%E4%BA%AC%E5%8A%9E%E4%BA%8B%E5%A4%84%E4%B8%8E%E4%B8%8A%E6%B5%B7%E5%8A%9E%E4%BA%8B%E5%A4%84%E4%B9%8B%E9%97%B4%E5%BB%BA%E7%AB%8Bvpn%E8%81%94%E6%8E%A5/><link crossorigin=anonymous href=/assets/css/stylesheet.e1f5c4cae44599655f7ff95195ff89c8cb3adbda94f2b1581a434ab2b4d4e6cf.css integrity="sha256-4fXEyuRFmWVff/lRlf+JyMs629qU8rFYGkNKsrTU5s8=" rel="preload stylesheet" as=style><link rel=icon href=https://seth.dpdns.org/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://seth.dpdns.org/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://seth.dpdns.org/favicon-32x32.png><link rel=apple-touch-icon href=https://seth.dpdns.org/apple-touch-icon.png><link rel=mask-icon href=https://seth.dpdns.org/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://seth.dpdns.org/posts/%E5%85%AC%E5%8F%B8%E7%9A%84%E5%8D%97%E4%BA%AC%E5%8A%9E%E4%BA%8B%E5%A4%84%E4%B8%8E%E4%B8%8A%E6%B5%B7%E5%8A%9E%E4%BA%8B%E5%A4%84%E4%B9%8B%E9%97%B4%E5%BB%BA%E7%AB%8Bvpn%E8%81%94%E6%8E%A5/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://seth.dpdns.org/posts/%E5%85%AC%E5%8F%B8%E7%9A%84%E5%8D%97%E4%BA%AC%E5%8A%9E%E4%BA%8B%E5%A4%84%E4%B8%8E%E4%B8%8A%E6%B5%B7%E5%8A%9E%E4%BA%8B%E5%A4%84%E4%B9%8B%E9%97%B4%E5%BB%BA%E7%AB%8Bvpn%E8%81%94%E6%8E%A5/"><meta property="og:site_name" content="Seth Dang'S"><meta property="og:title" content="公司的南京办事处与上海办事处之间建立VPN联接"><meta property="og:description" content="在公司的南京办事处与上海办事处之间建立VPN联接。
南京办事处网络设置：
内网IP 10.1.1.0/24
外网IP 202.102.1.5/24
上海办事处网络设置：
内网IP 10.1.2.0/24
外网IP 202.102.1.6/24
南京路由器配置
!
service timestamps debug uptime
service timestamps log uptime
no service password-encryption
!
hostname nanjing
!
enable cisco
!
! crypto isakmp policy 1 生成iskamp policy number 1
encryption des 选择用DES encryption也可用3DES指定三倍DES加密
hash sha 指定使用的散列算法，也可以是md5(二端保持一致)
authentication pre-share
group 1 指定为Diffie-Hellman组,1表示768位,2表示1024位
lifetime 14400 指定安全关联的有效期，不设就为默认值
-—–以下配置密钥方法—–
crypto isakmp identity address 指定与远程路由器通信时使用isakmp标识
crypto isakmp key 654321 address 202.102.1.6 对远程路由器端口202.102.1.6使用密钥654321
crypto isakmp key 654321 address 192.168.1.2 对远程路由器隧道端口192.168.1.2使用密钥654321
!
-—–以下定义一个转换集—–
crypto ipsec transform-set tset1 ah-md5-hmac esp-des esp-md5-hmac 可以定义一个或多个集
!
!
-——以下建立加密图——
crypto map cmap1 local-address serial 0 定义加密图cmap1并指定s0为本地地址
crypto map cmap1 1 ipsec-isakmp 用序号1设置加密图
set peer 202.102.1.6 设定目标地址
set peer 192.168.1.2
set transform-set test1 指定转换集
match address 111 指定加密访问列表111中的地址
!
!
process-max-time 200
!
-——以下设置隧道端口——
interface Tunnel0
ip address 192.168.1.1 255.255.255.0
tunnel source 202.102.1.5
tunnel destination 202.102.1.6
crypto map cmap
!
-——以下设置内网口——
interface Ethernet0
ip address 10.1.1.1 255.255.255.0
!
-——以下设置外网口——
interface serial0
ip address 202.102.1.5 255.255.255.0
no ip mroute-cache
no fair-queue
crypto map cmap
!
ip classless
!
-——以下建立访问列表111——
access-list 111 permit ip host 202.102.1.5 host 202.102.1.6
access-list 111 permit ip host 202.102.1.6 host 202.102.1.5
access-list 111 permit ip 10.1.1.0 0.0.0.255 202.102.1.0 0.0.0.255
access-list 111 permit ip 10.1.2.0 0.0.0.255 202.102.1.0 0.0.0.255
access-list 111 permit ip 10.1.1.0 0.0.0.255 10.1.2.0 0.0.0.255
access-list 111 permit ip 10.1.2.0 0.0.0.255 10.1.1.0 0.0.0.255
!
line con 0
line aux 0
line vty 0 4
password cisco
login
!
end
!"><meta property="og:locale" content="zh-CN"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2007-01-12T11:16:16+08:00"><meta property="article:modified_time" content="2007-01-12T11:16:16+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="公司的南京办事处与上海办事处之间建立VPN联接"><meta name=twitter:description content="在公司的南京办事处与上海办事处之间建立VPN联接。
南京办事处网络设置：
内网IP 10.1.1.0/24
外网IP 202.102.1.5/24
上海办事处网络设置：
内网IP 10.1.2.0/24
外网IP 202.102.1.6/24
南京路由器配置
!
service timestamps debug uptime
service timestamps log uptime
no service password-encryption
!
hostname nanjing
!
enable cisco
!
!
crypto isakmp policy 1 生成iskamp policy number 1
encryption des 选择用DES encryption也可用3DES指定三倍DES加密
hash sha 指定使用的散列算法，也可以是md5(二端保持一致)
authentication pre-share
group 1 指定为Diffie-Hellman组,1表示768位,2表示1024位
lifetime 14400 指定安全关联的有效期，不设就为默认值
-&mdash;&ndash;以下配置密钥方法&mdash;&ndash;
crypto isakmp identity address 指定与远程路由器通信时使用isakmp标识
crypto isakmp key 654321 address 202.102.1.6 对远程路由器端口202.102.1.6使用密钥654321
crypto isakmp key 654321 address 192.168.1.2 对远程路由器隧道端口192.168.1.2使用密钥654321
!
-&mdash;&ndash;以下定义一个转换集&mdash;&ndash;
crypto ipsec transform-set tset1 ah-md5-hmac esp-des esp-md5-hmac 可以定义一个或多个集
!
!
-&mdash;&mdash;以下建立加密图&mdash;&mdash;
crypto map cmap1 local-address serial 0 定义加密图cmap1并指定s0为本地地址
crypto map cmap1 1 ipsec-isakmp 用序号1设置加密图
set peer 202.102.1.6 设定目标地址
set peer 192.168.1.2
set transform-set test1 指定转换集
match address 111 指定加密访问列表111中的地址
!
!
process-max-time 200
!
-&mdash;&mdash;以下设置隧道端口&mdash;&mdash;
interface Tunnel0
ip address 192.168.1.1 255.255.255.0
tunnel source 202.102.1.5
tunnel destination 202.102.1.6
crypto map cmap
!
-&mdash;&mdash;以下设置内网口&mdash;&mdash;
interface Ethernet0
ip address 10.1.1.1 255.255.255.0
!
-&mdash;&mdash;以下设置外网口&mdash;&mdash;
interface serial0
ip address 202.102.1.5 255.255.255.0
no ip mroute-cache
no fair-queue
crypto map cmap
!
ip classless
!
-&mdash;&mdash;以下建立访问列表111&mdash;&mdash;
access-list 111 permit ip host 202.102.1.5 host 202.102.1.6
access-list 111 permit ip host 202.102.1.6 host 202.102.1.5
access-list 111 permit ip 10.1.1.0 0.0.0.255 202.102.1.0 0.0.0.255
access-list 111 permit ip 10.1.2.0 0.0.0.255 202.102.1.0 0.0.0.255
access-list 111 permit ip 10.1.1.0 0.0.0.255 10.1.2.0 0.0.0.255
access-list 111 permit ip 10.1.2.0 0.0.0.255 10.1.1.0 0.0.0.255
!
line con 0
line aux 0
line vty 0 4
password cisco
login
!
end
!"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://seth.dpdns.org/posts/"},{"@type":"ListItem","position":2,"name":"公司的南京办事处与上海办事处之间建立VPN联接","item":"https://seth.dpdns.org/posts/%E5%85%AC%E5%8F%B8%E7%9A%84%E5%8D%97%E4%BA%AC%E5%8A%9E%E4%BA%8B%E5%A4%84%E4%B8%8E%E4%B8%8A%E6%B5%B7%E5%8A%9E%E4%BA%8B%E5%A4%84%E4%B9%8B%E9%97%B4%E5%BB%BA%E7%AB%8Bvpn%E8%81%94%E6%8E%A5/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"公司的南京办事处与上海办事处之间建立VPN联接","name":"公司的南京办事处与上海办事处之间建立VPN联接","description":"在公司的南京办事处与上海办事处之间建立VPN联接。\n南京办事处网络设置：\n内网IP 10.1.1.0/24\n外网IP 202.102.1.5/24\n上海办事处网络设置：\n内网IP 10.1.2.0/24\n外网IP 202.102.1.6/24\n南京路由器配置\n!\nservice timestamps debug uptime\nservice timestamps log uptime\nno service password-encryption\n!\nhostname nanjing\n!\nenable cisco\n!\n! crypto isakmp policy 1 生成iskamp policy number 1\nencryption des 选择用DES encryption也可用3DES指定三倍DES加密\nhash sha 指定使用的散列算法，也可以是md5(二端保持一致)\nauthentication pre-share\ngroup 1 指定为Diffie-Hellman组,1表示768位,2表示1024位\nlifetime 14400 指定安全关联的有效期，不设就为默认值\n-\u0026mdash;\u0026ndash;以下配置密钥方法\u0026mdash;\u0026ndash;\ncrypto isakmp identity address 指定与远程路由器通信时使用isakmp标识\ncrypto isakmp key 654321 address 202.102.1.6 对远程路由器端口202.102.1.6使用密钥654321\ncrypto isakmp key 654321 address 192.168.1.2 对远程路由器隧道端口192.168.1.2使用密钥654321\n!\n-\u0026mdash;\u0026ndash;以下定义一个转换集\u0026mdash;\u0026ndash;\ncrypto ipsec transform-set tset1 ah-md5-hmac esp-des esp-md5-hmac 可以定义一个或多个集\n!\n!\n-\u0026mdash;\u0026mdash;以下建立加密图\u0026mdash;\u0026mdash;\ncrypto map cmap1 local-address serial 0 定义加密图cmap1并指定s0为本地地址\ncrypto map cmap1 1 ipsec-isakmp 用序号1设置加密图\nset peer 202.102.1.6 设定目标地址\nset peer 192.168.1.2\nset transform-set test1 指定转换集\nmatch address 111 指定加密访问列表111中的地址\n!\n!\nprocess-max-time 200\n!\n-\u0026mdash;\u0026mdash;以下设置隧道端口\u0026mdash;\u0026mdash;\ninterface Tunnel0\nip address 192.168.1.1 255.255.255.0\ntunnel source 202.102.1.5\ntunnel destination 202.102.1.6\ncrypto map cmap\n!\n-\u0026mdash;\u0026mdash;以下设置内网口\u0026mdash;\u0026mdash;\ninterface Ethernet0\nip address 10.1.1.1 255.255.255.0\n!\n-\u0026mdash;\u0026mdash;以下设置外网口\u0026mdash;\u0026mdash;\ninterface serial0\nip address 202.102.1.5 255.255.255.0\nno ip mroute-cache\nno fair-queue\ncrypto map cmap\n!\nip classless\n!\n-\u0026mdash;\u0026mdash;以下建立访问列表111\u0026mdash;\u0026mdash;\naccess-list 111 permit ip host 202.102.1.5 host 202.102.1.6\naccess-list 111 permit ip host 202.102.1.6 host 202.102.1.5\naccess-list 111 permit ip 10.1.1.0 0.0.0.255 202.102.1.0 0.0.0.255\naccess-list 111 permit ip 10.1.2.0 0.0.0.255 202.102.1.0 0.0.0.255\naccess-list 111 permit ip 10.1.1.0 0.0.0.255 10.1.2.0 0.0.0.255\naccess-list 111 permit ip 10.1.2.0 0.0.0.255 10.1.1.0 0.0.0.255\n!\nline con 0\nline aux 0\nline vty 0 4\npassword cisco\nlogin\n!\nend\n!\n","keywords":[],"articleBody":"在公司的南京办事处与上海办事处之间建立VPN联接。\n南京办事处网络设置：\n内网IP 10.1.1.0/24\n外网IP 202.102.1.5/24\n上海办事处网络设置：\n内网IP 10.1.2.0/24\n外网IP 202.102.1.6/24\n南京路由器配置\n!\nservice timestamps debug uptime\nservice timestamps log uptime\nno service password-encryption\n!\nhostname nanjing\n!\nenable cisco\n!\n! crypto isakmp policy 1 生成iskamp policy number 1\nencryption des 选择用DES encryption也可用3DES指定三倍DES加密\nhash sha 指定使用的散列算法，也可以是md5(二端保持一致)\nauthentication pre-share\ngroup 1 指定为Diffie-Hellman组,1表示768位,2表示1024位\nlifetime 14400 指定安全关联的有效期，不设就为默认值\n-—–以下配置密钥方法—–\ncrypto isakmp identity address 指定与远程路由器通信时使用isakmp标识\ncrypto isakmp key 654321 address 202.102.1.6 对远程路由器端口202.102.1.6使用密钥654321\ncrypto isakmp key 654321 address 192.168.1.2 对远程路由器隧道端口192.168.1.2使用密钥654321\n!\n-—–以下定义一个转换集—–\ncrypto ipsec transform-set tset1 ah-md5-hmac esp-des esp-md5-hmac 可以定义一个或多个集\n!\n!\n-——以下建立加密图——\ncrypto map cmap1 local-address serial 0 定义加密图cmap1并指定s0为本地地址\ncrypto map cmap1 1 ipsec-isakmp 用序号1设置加密图\nset peer 202.102.1.6 设定目标地址\nset peer 192.168.1.2\nset transform-set test1 指定转换集\nmatch address 111 指定加密访问列表111中的地址\n!\n!\nprocess-max-time 200\n!\n-——以下设置隧道端口——\ninterface Tunnel0\nip address 192.168.1.1 255.255.255.0\ntunnel source 202.102.1.5\ntunnel destination 202.102.1.6\ncrypto map cmap\n!\n-——以下设置内网口——\ninterface Ethernet0\nip address 10.1.1.1 255.255.255.0\n!\n-——以下设置外网口——\ninterface serial0\nip address 202.102.1.5 255.255.255.0\nno ip mroute-cache\nno fair-queue\ncrypto map cmap\n!\nip classless\n!\n-——以下建立访问列表111——\naccess-list 111 permit ip host 202.102.1.5 host 202.102.1.6\naccess-list 111 permit ip host 202.102.1.6 host 202.102.1.5\naccess-list 111 permit ip 10.1.1.0 0.0.0.255 202.102.1.0 0.0.0.255\naccess-list 111 permit ip 10.1.2.0 0.0.0.255 202.102.1.0 0.0.0.255\naccess-list 111 permit ip 10.1.1.0 0.0.0.255 10.1.2.0 0.0.0.255\naccess-list 111 permit ip 10.1.2.0 0.0.0.255 10.1.1.0 0.0.0.255\n!\nline con 0\nline aux 0\nline vty 0 4\npassword cisco\nlogin\n!\nend\n!\n上海路由器配置\n!\nservice timestamps debug uptime\nservice timestamps log uptime\nno service password-encryption\n!\nhostname shanghai\n!\nenable cisco\n!\n!\n!——以下配置加密——–\ncrypto isakmp policy 1 生成iskamp policy number 1\nencryption des 选择用DES encryption也可用3DES指定三倍DES加密\nhash sha 指定使用的散列算法，也可以是md5(二端保持一致)\nauthentication pre-share\ngroup 1 指定为Diffie-Hellman组,1表示768位,2表示1024位\nlifetime 14400 指定安全关联的有效期，不设就为默认值\n-—–以下配置密钥方法—–\ncrypto isakmp identity address 指定与远程路由器通信时使用isakmp标识\ncrypto isakmp key 654321 address 202.102.1.5 对远程路由器端口202.102.1.6使用密钥654321\ncrypto isakmp key 654321 address 202.102.1.6 对远程路由器端口202.102.1.6使用密钥654321\ncrypto isakmp key 654321 address 192.168.1.1 对远程路由器隧道端口192.168.1.2使用密钥654321\n!\n-—–以下定义一个转换集—–\ncrypto ipsec transform-set tset1 ah-md5-hmac esp-des esp-md5-hmac 可以定义一个或多个集\n!\n!\n-——以下建立加密图——\ncrypto map cmap1 local-address serial 0 定义加密图cmap1并指定s0为本地地址\ncrypto map cmap1 1 ipsec-isakmp 用序号1设置加密图\nset peer 202.102.1.5 设定目标地址\nset peer 202.102.1.6\nset peer 192.168.1.1\nset transform-set test1 指定转换集\nmatch address 111 指定加密访问列表111中的地址\n!\n!\nprocess-max-time 200\n!\n-——以下设置隧道端口——\ninterface Tunnel0\nip address 192.168.1.2 255.255.255.0\ntunnel source 202.102.1.6\ntunnel destination 202.102.1.5\ncrypto map cmap\n!\n-——以下设置内网口——\ninterface Ethernet0\nip address 10.1.2.1 255.255.255.0\n!\n-——以下设置外网口——\ninterface serial0\nip address 202.102.1.6 255.255.255.0\nno ip mroute-cache\nno fair-queue\ncrypto map cmap\n!\nip classless\n!\n-——以下建立访问列表111——\naccess-list 111 permit ip host 202.102.1.5 host 202.102.1.6\naccess-list 111 permit ip host 202.102.1.6 host 202.102.1.5\naccess-list 111 permit ip 10.1.1.0 0.0.0.255 202.102.1.0 0.0.0.255\naccess-list 111 permit ip 10.1.2.0 0.0.0.255 202.102.1.0 0.0.0.255\naccess-list 111 permit ip 10.1.1.0 0.0.0.255 10.1.2.0 0.0.0.255\naccess-list 111 permit ip 10.1.2.0 0.0.0.255 10.1.1.0 0.0.0.255\n!\nline con 0\nline aux 0\nline vty 0 4\n==============================\npassword cisco\nlogin\n!\nend\n!\n","wordCount":"463","inLanguage":"en","datePublished":"2007-01-12T11:16:16+08:00","dateModified":"2007-01-12T11:16:16+08:00","author":{"@type":"Person","name":"Seth"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://seth.dpdns.org/posts/%E5%85%AC%E5%8F%B8%E7%9A%84%E5%8D%97%E4%BA%AC%E5%8A%9E%E4%BA%8B%E5%A4%84%E4%B8%8E%E4%B8%8A%E6%B5%B7%E5%8A%9E%E4%BA%8B%E5%A4%84%E4%B9%8B%E9%97%B4%E5%BB%BA%E7%AB%8Bvpn%E8%81%94%E6%8E%A5/"},"publisher":{"@type":"Organization","name":"Seth Dang'S","logo":{"@type":"ImageObject","url":"https://seth.dpdns.org/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://seth.dpdns.org/ accesskey=h title="Seth Dang'S (Alt + H)">Seth Dang'S</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">公司的南京办事处与上海办事处之间建立VPN联接</h1><div class=post-meta><span title='2007-01-12 11:16:16 +0800 +0800'>January 12, 2007</span>&nbsp;·&nbsp;Seth</div></header><div class=post-content><p>在公司的南京办事处与上海办事处之间建立VPN联接。<br>南京办事处网络设置：<br>内网IP 10.1.1.0/24<br>外网IP 202.102.1.5/24<br>上海办事处网络设置：<br>内网IP 10.1.2.0/24<br>外网IP 202.102.1.6/24</p><h1 id=heading>南京路由器配置<br>!<br>service timestamps debug uptime<br>service timestamps log uptime<br>no service password-encryption<br>!<br>hostname nanjing<br>!<br>enable cisco<br>!<br>!</h1><p>crypto isakmp policy 1 生成iskamp policy number 1<br>encryption des 选择用DES encryption也可用3DES指定三倍DES加密<br>hash sha 指定使用的散列算法，也可以是md5(二端保持一致)<br>authentication pre-share<br>group 1 指定为Diffie-Hellman组,1表示768位,2表示1024位<br>lifetime 14400 指定安全关联的有效期，不设就为默认值<br>-&mdash;&ndash;以下配置密钥方法&mdash;&ndash;<br>crypto isakmp identity address 指定与远程路由器通信时使用isakmp标识<br>crypto isakmp key 654321 address 202.102.1.6 对远程路由器端口202.102.1.6使用密钥654321<br>crypto isakmp key 654321 address 192.168.1.2 对远程路由器隧道端口192.168.1.2使用密钥654321<br>!<br>-&mdash;&ndash;以下定义一个转换集&mdash;&ndash;<br>crypto ipsec transform-set tset1 ah-md5-hmac esp-des esp-md5-hmac 可以定义一个或多个集<br>!<br>!<br>-&mdash;&mdash;以下建立加密图&mdash;&mdash;<br>crypto map cmap1 local-address serial 0 定义加密图cmap1并指定s0为本地地址<br>crypto map cmap1 1 ipsec-isakmp 用序号1设置加密图<br>set peer 202.102.1.6 设定目标地址<br>set peer 192.168.1.2<br>set transform-set test1 指定转换集<br>match address 111 指定加密访问列表111中的地址<br>!<br>!<br>process-max-time 200<br>!<br>-&mdash;&mdash;以下设置隧道端口&mdash;&mdash;<br>interface Tunnel0<br>ip address 192.168.1.1 255.255.255.0<br>tunnel source 202.102.1.5<br>tunnel destination 202.102.1.6<br>crypto map cmap<br>!<br>-&mdash;&mdash;以下设置内网口&mdash;&mdash;<br>interface Ethernet0<br>ip address 10.1.1.1 255.255.255.0<br>!<br>-&mdash;&mdash;以下设置外网口&mdash;&mdash;<br>interface serial0<br>ip address 202.102.1.5 255.255.255.0<br>no ip mroute-cache<br>no fair-queue<br>crypto map cmap<br>!<br>ip classless<br>!<br>-&mdash;&mdash;以下建立访问列表111&mdash;&mdash;<br>access-list 111 permit ip host 202.102.1.5 host 202.102.1.6<br>access-list 111 permit ip host 202.102.1.6 host 202.102.1.5<br>access-list 111 permit ip 10.1.1.0 0.0.0.255 202.102.1.0 0.0.0.255<br>access-list 111 permit ip 10.1.2.0 0.0.0.255 202.102.1.0 0.0.0.255<br>access-list 111 permit ip 10.1.1.0 0.0.0.255 10.1.2.0 0.0.0.255<br>access-list 111 permit ip 10.1.2.0 0.0.0.255 10.1.1.0 0.0.0.255<br>!<br>line con 0<br>line aux 0<br>line vty 0 4<br>password cisco<br>login<br>!<br>end<br>!</p><p>上海路由器配置<br>!<br>service timestamps debug uptime<br>service timestamps log uptime<br>no service password-encryption<br>!<br>hostname shanghai<br>!<br>enable cisco<br>!<br>!<br>!&mdash;&mdash;以下配置加密&mdash;&mdash;&ndash;<br>crypto isakmp policy 1 生成iskamp policy number 1<br>encryption des 选择用DES encryption也可用3DES指定三倍DES加密<br>hash sha 指定使用的散列算法，也可以是md5(二端保持一致)<br>authentication pre-share<br>group 1 指定为Diffie-Hellman组,1表示768位,2表示1024位<br>lifetime 14400 指定安全关联的有效期，不设就为默认值<br>-&mdash;&ndash;以下配置密钥方法&mdash;&ndash;<br>crypto isakmp identity address 指定与远程路由器通信时使用isakmp标识<br>crypto isakmp key 654321 address 202.102.1.5 对远程路由器端口202.102.1.6使用密钥654321<br>crypto isakmp key 654321 address 202.102.1.6 对远程路由器端口202.102.1.6使用密钥654321<br>crypto isakmp key 654321 address 192.168.1.1 对远程路由器隧道端口192.168.1.2使用密钥654321<br>!<br>-&mdash;&ndash;以下定义一个转换集&mdash;&ndash;<br>crypto ipsec transform-set tset1 ah-md5-hmac esp-des esp-md5-hmac 可以定义一个或多个集<br>!<br>!<br>-&mdash;&mdash;以下建立加密图&mdash;&mdash;<br>crypto map cmap1 local-address serial 0 定义加密图cmap1并指定s0为本地地址<br>crypto map cmap1 1 ipsec-isakmp 用序号1设置加密图<br>set peer 202.102.1.5 设定目标地址<br>set peer 202.102.1.6<br>set peer 192.168.1.1<br>set transform-set test1 指定转换集<br>match address 111 指定加密访问列表111中的地址<br>!<br>!<br>process-max-time 200<br>!<br>-&mdash;&mdash;以下设置隧道端口&mdash;&mdash;<br>interface Tunnel0<br>ip address 192.168.1.2 255.255.255.0<br>tunnel source 202.102.1.6<br>tunnel destination 202.102.1.5<br>crypto map cmap<br>!<br>-&mdash;&mdash;以下设置内网口&mdash;&mdash;<br>interface Ethernet0<br>ip address 10.1.2.1 255.255.255.0<br>!<br>-&mdash;&mdash;以下设置外网口&mdash;&mdash;<br>interface serial0<br>ip address 202.102.1.6 255.255.255.0<br>no ip mroute-cache<br>no fair-queue<br>crypto map cmap<br>!<br>ip classless<br>!<br>-&mdash;&mdash;以下建立访问列表111&mdash;&mdash;<br>access-list 111 permit ip host 202.102.1.5 host 202.102.1.6<br>access-list 111 permit ip host 202.102.1.6 host 202.102.1.5<br>access-list 111 permit ip 10.1.1.0 0.0.0.255 202.102.1.0 0.0.0.255<br>access-list 111 permit ip 10.1.2.0 0.0.0.255 202.102.1.0 0.0.0.255<br>access-list 111 permit ip 10.1.1.0 0.0.0.255 10.1.2.0 0.0.0.255<br>access-list 111 permit ip 10.1.2.0 0.0.0.255 10.1.1.0 0.0.0.255<br>!<br>line con 0<br>line aux 0<br>line vty 0 4</p><p>==============================<br>password cisco<br>login<br>!<br>end<br>!</p></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://seth.dpdns.org/>Seth Dang'S</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>